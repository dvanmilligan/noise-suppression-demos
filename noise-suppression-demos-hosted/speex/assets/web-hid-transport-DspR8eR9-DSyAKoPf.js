import{S as n,o,Z as s,n as i,s as d,q as c}from"./index-CV4KLuUB.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";class b{constructor(r,e,t){this.webHidHandler=r,this.logger=e,this.recorder=t,this.events=new n,this.consoleAppEvent=this.events,this.webHidConnected=!1,this.context=o.WEB_HID}connect(){return this.webHidConnected?Promise.reject(new s("Already connected",i.UNEXPECTED_ERROR)):(this.webHidHandler.events.subscribe((r=>{var e;let t=r;this.recorder&&(t=(e=this.recorder)===null||e===void 0?void 0:e.recordInput(t)),this.events.next(t)})),this.webHidHandler.start(),this.webHidConnected=!0,Promise.resolve())}writeAction(r){var e;if(!this.webHidConnected){const t="WebHID is uninitialized.";throw d(t,this.logger,c.ERROR),new s(t,i.INIT_ERROR)}return(e=this.recorder)===null||e===void 0||e.recordOutput(r),this.webHidHandler.sendMessage(r)}}export{b as WebHidTransport};
