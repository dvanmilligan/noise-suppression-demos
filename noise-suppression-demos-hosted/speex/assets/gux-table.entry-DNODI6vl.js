import{r as u,c as h,f as b,b as m,h as a,H as g,g as p}from"./index-CV4KLuUB.js";import{b as f}from"./index-3f1e5ba8-CrdMLsjJ.js";import{w as d}from"./when-event-is-from-2aac15f0-B4cyA2sH.js";import{r as S}from"./random-html-id-81ac821b-D30kRngR.js";import{t as C}from"./usage-6129fffe-6kP8_2TX.js";import{t as z}from"./en-1f9d79e6-D5hlE5o5.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-728b9f18-C_5KDHD-.js";const y=":host{display:block;isolation:isolate}:host .gux-table{position:relative;height:inherit}:host .gux-table .gux-table-container{max-height:100%;overflow:auto;scrollbar-color:var(--gse-ui-dataTableItems-scrollbar-foregroundColor);scrollbar-width:thin}:host .gux-table .gux-table-container.gux-column-resizing-hover,:host .gux-table .gux-table-container.gux-column-resizing{cursor:col-resize}:host .gux-empty-table{display:flex;align-items:center;justify-content:center;height:calc(100% - var(--gse-ui-dataTableItems-header-default-height));color:#596373;background:#fdfdfd;font-family:var(--gse-core-typography-heading-lg-fontFamily), var(--gse-core-fontFamily-heading), sans-serif;font-size:var(--gse-core-typography-heading-lg-fontSize);line-height:var(--gse-core-typography-heading-lg-lineHeight);font-weight:var(--gse-core-fontWeight-bold)}",x=y,w=3,R=class{constructor(e){u(this,e),this.guxselectionchanged=h(this,"guxselectionchanged",7),this.guxsortchanged=h(this,"guxsortchanged",7),this.slotObserver=new MutationObserver(()=>b(this)),this.tableId=S("gux-table"),this.columnsWidths={},this.isVerticalScroll=!1,this.columnResizeHover=!1,this.compact=!1,this.objectTable=!1,this.emptyMessage=void 0,this.resizableColumns=void 0}async componentWillLoad(){C(this.root),this.i18n=await f(this.root,z)}componentDidLoad(){this.resizableColumns&&this.prepareResizableColumns(),this.prepareSelectableRows(),this.checkVerticalScroll(),!this.resizeObserver&&window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{m(()=>{this.checkVerticalScroll()})})),this.resizeObserver&&(this.resizeObserver.observe(this.tableContainer),this.resizeObserver.observe(this.slottedTable)),this.slotObserver.observe(this.slottedTable,{subtree:!0,childList:!0})}checkVerticalScroll(){const e=this.tableContainer;this.isVerticalScroll=e.scrollHeight>e.clientHeight}disconnectedCallback(){this.resizeObserver&&(this.resizeObserver.unobserve(this.tableContainer),this.resizeObserver.unobserve(this.slottedTable)),this.resizableColumns&&document.getElementById(`${this.tableId}-resizable-styles`).remove()}onInternalAllRowSelectChange(e){e.stopPropagation(),this.handleSelectAllRows(e.detail)}onInternalRowSelectChange(e){e.stopPropagation();const t=e.target;t.selected=e.detail,this.handleRowSelection(t)}onMouseMove(e){this.resizableColumns&&this.updateResizeState(e)}onMouseDown(e){this.resizableColumns&&this.maybeStartResizing(e)}onMouseUp(){this.resizableColumns&&this.stopResizing()}get tableContainer(){return this.root.shadowRoot.querySelector(".gux-table-container")}get slottedTable(){return this.root.querySelector('table[slot="data"]')}get tableRows(){return Array.from(this.slottedTable.querySelectorAll("tbody tr"))}get tableColumns(){return Array.from(this.slottedTable.querySelectorAll("thead th"))}get rowCheckboxes(){return Array.from(this.slottedTable.querySelectorAll("tbody tr td gux-row-select"))}get selectAllCheckbox(){return this.slottedTable.querySelector("thead tr th gux-all-row-select")}async getSelected(){return this.getSelectedInternal()}getSelectedInternal(){return{selectedRowIds:Array.from(this.rowCheckboxes).filter(s=>s.selected).map(s=>s.closest("tr").getAttribute("data-row-id"))}}prepareSelectableRows(){this.rowCheckboxes.forEach(t=>{this.updateRowSelection(t)}),this.updateSelectAllBoxState()}updateSelectAllBoxState(){const e=this.selectAllCheckbox;if(e){const t=this.rowCheckboxes,s=t.filter(l=>!l.hasAttribute("disabled")),i=s.filter(l=>l.selected),r=!!t.length,n=i.length===s.length,c=i.length===0;e.selected=r&&n,e.setIndeterminate(r&&!n&&!c)}}handleSelectAllRows(e){const t=this.selectAllCheckbox;this.rowCheckboxes.forEach(i=>{t.selected=e,i.hasAttribute("disabled")||(i.selected=e,this.updateRowSelection(i))}),this.emitSelectionEvent()}handleRowSelection(e){this.updateRowSelection(e),this.updateSelectAllBoxState(),this.emitSelectionEvent()}emitSelectionEvent(){this.guxselectionchanged.emit(this.getSelectedInternal())}updateRowSelection(e){const t=e.closest("tr");e.selected?t.setAttribute("data-selected-row",""):t.removeAttribute("data-selected-row")}prepareResizableColumns(){const e=document.createElement("style");e.id=`${this.tableId}-resizable-styles`,document.querySelector("head").appendChild(e),this.calculateColumnWidths(this.tableColumns).slice(0,-1).forEach(s=>this.columnsWidths[s.name]=s.width),this.setResizableColumnsStyles()}updateResizeState(e){if(this.columnResizeState){const s=this.columnResizeState.resizableColumn.dataset.columnName,i=e.pageX-this.columnResizeState.columnResizeMouseStartX,n=this.columnResizeState.resizableColumnInitialWidth+i,c=Math.max(n,1),l=this.calculateColumnWidths(this.tableColumns).map(o=>o.name===s?Object.assign(Object.assign({},o),{width:c}):o);this.columnsWidths[s]=l.find(o=>o.name===s).width,this.setResizableColumnsStyles()}else this.columnResizeHover=!1,d("th",e,t=>{!(this.tableColumns.length-1===t.cellIndex)&&this.isInResizeZone(e,t)&&(this.columnResizeHover=!0)})}maybeStartResizing(e){d("th",e,t=>{if(this.isInResizeZone(e,t)){const s=t;this.columnResizeState={resizableColumn:s,columnResizeMouseStartX:e.pageX,resizableColumnInitialWidth:s.clientWidth}}})}stopResizing(){this.columnResizeState&&(this.columnResizeState=null)}isInResizeZone(e,t){return t.getBoundingClientRect().right-e.clientX<w}calculateColumnWidths(e){return e.map(t=>({name:t.dataset.columnName,width:t.clientWidth}))}setResizableColumnsStyles(){const e=document.getElementById(`${this.tableId}-resizable-styles`);let t="";Object.keys(this.columnsWidths).forEach(s=>{t+=`[gs-table-id=${this.tableId}] th[data-column-name="${s}"]{
        width:${String(this.columnsWidths[s])}px;
        min-width:${String(this.columnsWidths[s])}px;
      }`}),e.innerHTML=t}get isTableEmpty(){return!this.root.children[0]||this.tableRows.length<1}get tableContainerClasses(){return{"gux-table-container":!0,"gux-column-resizing":!!this.columnResizeState,"gux-column-resizing-hover":this.columnResizeHover}}render(){return a(g,{key:"d3d13677347a9fe486ede8821c7e4c25dc74be84","gs-table-id":this.tableId,"gs-obj-table":this.objectTable,"gs-compact":this.compact},a("div",{key:"43238297243e556d3a24d30afcea5528a67be6b6",class:"gux-table"},a("div",{key:"6d7630e5f1b0ca672398af99ee13fe451ac583ac",tabindex:this.isVerticalScroll?"0":"-1",id:this.tableId,class:this.tableContainerClasses},a("slot",{key:"4f48ee186137a7635674d944600459ec687b272c",name:"data"})),this.isTableEmpty&&a("div",{class:"gux-empty-table"},this.emptyMessage||this.i18n("emptyMessage"))))}get root(){return p(this)}};R.style=x;export{R as gux_table};
