import{S as o,o as r,Z as i,n as a,Q as c}from"./index-CV4KLuUB.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";class s{constructor(t,e){this.logger=t,this.recorder=e,this.events=new o,this.consoleAppEvent=this.events,this.connectHasBeenCalled=!1,this.context=r.CHROME_EXTENSION}connect(){return this.connectHasBeenCalled?Promise.reject(new i("Already connected",a.UNEXPECTED_ERROR)):(this.connectHasBeenCalled=!0,window.addEventListener("message-from-jabra-chrome-extension",(t=>{var e;let n=t.detail;this.recorder&&(n=(e=this.recorder)===null||e===void 0?void 0:e.recordInput(n)),this.events.next(n)})),this.writeAction({event:"ping"}),Promise.resolve())}static sendToBrowserExtension(t){const e=new CustomEvent("message-to-jabra-chrome-extension",{detail:structuredClone(t)});window.dispatchEvent(e)}static checkInstallation(){return c(this,void 0,void 0,(function*(){return new Promise((t=>{s.sendToBrowserExtension("check-console-app-installation"),window.addEventListener("installation-status-from-jabra-chrome-extension",(e=>{t({ok:e.detail,message:e.detail?"Installation ok":"The Jabra Chromehost is not installed"})})),setTimeout((()=>{t({ok:!1,message:"The Jabra Chrome Extension is not installed"})}),3e3)}))}))}writeAction(t){var e;return(e=this.recorder)===null||e===void 0||e.recordOutput(t),s.sendToBrowserExtension(t),Promise.resolve()}}export{s as TransportChromeExtension};
