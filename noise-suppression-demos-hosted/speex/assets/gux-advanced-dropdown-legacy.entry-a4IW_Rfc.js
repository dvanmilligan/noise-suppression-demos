import{r as p,c as d,h as o,g as u}from"./index-CV4KLuUB.js";import{o as h}from"./on-mutation-a222fe93-BUuUxYmY.js";import{O as f}from"./on-click-outside-21dd269e-9ljsEeio.js";import{a as g}from"./after-next-render-07a41f53-C_KTwidI.js";import{t as x}from"./usage-6129fffe-6kP8_2TX.js";import{b}from"./index-3f1e5ba8-CrdMLsjJ.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-728b9f18-C_5KDHD-.js";const w="Search",m={searchAria:w},v=":host{color:#2e394c}gux-popup{display:block;margin:4px 0}gux-popup .gux-select-field{position:relative;width:100%;height:32px}gux-popup .gux-select-field a.gux-select-input{position:absolute;inset:0;padding:6px 24px 6px 12px;overflow:hidden;color:#2e394c;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;background-color:#f6f7f9;background-image:none;border:1px solid #6b7585;border-radius:4px;box-shadow:inset 0 0 4px rgba(32, 41, 55, 0.16)}gux-popup .gux-select-field a.gux-select-input .gux-select-placeholder,gux-popup .gux-select-field a.gux-select-input .gux-select-value{line-height:20px}gux-popup .gux-select-field a.gux-select-input .gux-select-placeholder{color:#596373}gux-popup .gux-select-field a.gux-select-input:focus-visible{outline:none;box-shadow:0 0 0 3px rgba(117, 168, 255, 0.5)}gux-popup .gux-select-field .gux-icon-wrapper{position:absolute;top:1px;right:8px;bottom:0;display:flex;align-items:center;overflow:hidden;cursor:pointer}gux-popup .gux-select-field .gux-icon-wrapper gux-icon{width:16px;height:16px;color:#596373}gux-popup .gux-select-field:hover .gux-icon-wrapper gux-icon{color:#2e394c}gux-popup .gux-advanced-dropdown-menu{background:#fdfdfd;border:1px solid #b4bccb;border-radius:4px;box-shadow:0 0 2px 0 rgba(32, 41, 55, 0.24)}gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search{margin:8px 16px}gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-search-cancel-button,gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-search-results-button,gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-calendar-picker-indicator{display:none;-webkit-appearance:none}gux-popup .gux-dropdown-options{padding:8px 0;margin:0;overflow-y:auto;color:#2e394c;background:#fdfdfd;border-radius:4px;box-shadow:none}",y=v;var O=function(e,t,n,s){var r=arguments.length,i=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,n):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(c=e[a])&&(i=(r<3?c(i):r>3?c(t,n,i):c(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i};const l=class{constructor(e){p(this,e),this.input=d(this,"input",7),this.filter=d(this,"filter",7),this.disabled=!1,this.placeholder=void 0,this.noFilter=!1,this.filterDebounceTimeout=500,this.dropdownHeight="320px",this.srLabelledby=void 0,this.opened=void 0,this.currentlySelectedOption=void 0,this.selectionOptions=void 0}watchValue(e){this.opened&&e&&this.closeDropdown(!1)}get value(){var e;return(e=this.currentlySelectedOption)===null||e===void 0?void 0:e.text}getSelectedValues(){return Promise.resolve([this.value])}async setLabeledBy(e){this.srLabelledby=e}onClickOutside(){this.closeDropdown(!1)}async componentWillLoad(){x(this.root),this.i18n=await b(this.root,m),this.handleSelectionChange=this.handleSelectionChange.bind(this),this.updateSelectionState(),this.addOptionListener(),this.slotObserver=h(this.root,()=>this.updateSelectionState())}disconnectedCallback(){this.slotObserver&&this.slotObserver.disconnect()}render(){return o("gux-popup",{key:"2c5de5f92f4dce1dd951db895a0ab512547985c8",expanded:this.opened,disabled:this.disabled},o("div",{key:"c14dafe787022b47f07aa8d737b7760472a191bd",slot:"target",class:"gux-select-field",onMouseDown:()=>this.inputMouseDown()},o("a",{key:"3d0ec0564f68b994c679e42065d28a575a85a3ec",ref:e=>this.inputBox=e,class:"gux-select-input","aria-labelledby":this.srLabelledby,tabindex:"0",onKeyDown:e=>this.inputKeyDown(e)},this.placeholder&&!this.value&&o("span",{class:"gux-select-placeholder",title:this.placeholder},this.placeholder),this.value&&o("span",{class:"gux-select-value",title:this.value},this.value)),o("div",{key:"13dcc9e0862e703cf1234da0fe6ad0e4c28f9af8",class:"gux-icon-wrapper"},o("gux-icon",{key:"ce3c4d155fcff7cf9d6d4db5cf6f117597206c26",decorative:!0,"icon-name":"custom/chevron-down-small-regular"}))),o("div",{key:"1fcdd802c23dfa44314e0bc59cd80aabeefca46a",slot:"popup",class:"gux-advanced-dropdown-menu"},o("div",{key:"bc04ecfec978b27cba974f1c15925a20cfd687b7",class:"gux-dropdown-menu-container"},o("gux-form-field-search",{key:"ce05782596e319c58f2c3241b00a85337e8315ec","label-position":"screenreader"},o("label",{key:"2149aa815abf753ef1148eafd820028f463615b3",slot:"label"},this.i18n("searchAria")),o("input",{key:"1c74a3fef26208f9a4150736f8b17eb8922c496e",slot:"input",type:"search",onInput:e=>{this.handleSearchInput(e)},ref:e=>this.searchInput=e})),o("div",{key:"6c1da64b7dd06cf8ccd8b16434d16f55ac4392c2",class:"gux-dropdown-options",style:{maxHeight:this.dropdownHeight},onKeyDown:e=>this.optionsKeyDown(e)},o("slot",{key:"ca6a7bbc4924788bddc39aa2007d471430915829"})))))}updateSelectionState(){this.selectionOptions=this.getSelectionOptions(),this.currentlySelectedOption=this.selectionOptions.find(e=>e.selected)}addOptionListener(){this.root.addEventListener("selectedChanged",e=>this.handleSelectionChange(e))}handleSelectionChange({target:e}){const t=e;this.closeDropdown(!0),this.currentlySelectedOption!==t&&(this.currentlySelectedOption&&(this.currentlySelectedOption.selected=!1),this.currentlySelectedOption=t,this.input.emit(t.value))}getSelectionOptions(){const e=this.root.querySelectorAll("gux-dropdown-option");return Array.from(e)}inputMouseDown(){this.disabled||(this.opened?this.closeDropdown(!0):this.openDropdown(!1))}getFocusIndex(){return this.selectionOptions.findIndex(e=>e.matches(":focus"))}optionsKeyDown(e){switch(e.key){case"ArrowUp":{e.preventDefault();const t=this.getFocusIndex();t>0&&this.selectionOptions[t-1].focus();break}case"ArrowDown":{e.preventDefault();const t=this.getFocusIndex();t<this.selectionOptions.length-1&&this.selectionOptions[t+1].focus();break}case"Home":if(!this.selectionOptions.length)return;this.selectionOptions[0].focus();break;case"End":if(!this.selectionOptions.length)return;this.selectionOptions[this.selectionOptions.length-1].focus();break}}inputKeyDown(e){switch(e.key){case"ArrowUp":case"ArrowDown":case" ":this.openDropdown(!0);break}}handleSearchInput(e){e.stopPropagation(),clearTimeout(this.filterDebounceTimer),this.filterDebounceTimer=setTimeout(()=>this.searchRequested(),this.filterDebounceTimeout)}searchRequested(){const e=this.searchInput.value;this.filter.emit(e),this.setFilteredOptions()}setFilteredOptions(){const e=this.searchInput.value;if(!this.noFilter)for(const t of this.selectionOptions)t.shouldFilter(e).then(n=>{t.filtered=n})}changeFocusToSearch(){g(()=>{this.searchInput.focus()})}openDropdown(e){this.opened=!0,e&&this.changeFocusToSearch()}closeDropdown(e){this.opened=!1,this.searchInput.value="",this.setFilteredOptions(),e&&this.inputBox.focus()}get root(){return u(this)}static get watchers(){return{disabled:["watchValue"]}}};O([f({triggerEvents:"mousedown"})],l.prototype,"onClickOutside",null);l.style=y;export{l as gux_advanced_dropdown_legacy};
