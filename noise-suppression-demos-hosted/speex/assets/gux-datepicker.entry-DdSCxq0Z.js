import{r as F,c as D,h as o,g as I}from"./index-CV4KLuUB.js";import{a as C,c as w,o as R,f as S}from"./floating-ui.dom.esm-8b93f9de-BrzsGlin.js";import{r as f}from"./random-html-id-81ac821b-D30kRngR.js";import{a as p}from"./after-next-render-07a41f53-C_KTwidI.js";import{f as d,b as m,a as x,c as v}from"./iso-dates-8d3f106d-Dhyd_FQE.js";import{O as E}from"./on-click-outside-21dd269e-9ljsEeio.js";import{t as M}from"./usage-6129fffe-6kP8_2TX.js";import{b as O}from"./index-3f1e5ba8-CrdMLsjJ.js";import{u as V,g as P,a as Y}from"./use-regional-dates-a47e74e6-CHt-lzjs.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-728b9f18-C_5KDHD-.js";const T="Start",U="End",z="Date",A="Toggle calendar view",L={start:T,end:U,date:z,toggleCalendar:A};function $(e,t,i){const a=e.split(",").map(r=>r.trim());return t==="range"?[a[0]||i[0],a[1]||i[1]]:t!=="range"&&!a[0]?[i[2]]:[a[0]]}function W(e,t,i){return i&&i<e||t&&t>e}function j(e){let t=e;for(;t<0;)t+=12;return t=t%12,t}function b(e,t){let i=new Date(t.getTime());return i.setDate(i.getDate()+e),e<0?i.getDate()>t.getDate()&&(i=new Date(t.getFullYear(),t.getMonth()+1,0,0,0,0)):i.getDate()<t.getDate()&&i.setMonth(i.getMonth()-1),i}function k(e,t){const i=new Date(t.valueOf()),a=j(i.getMonth()+e);return i.setMonth(a),i.setFullYear(t.getFullYear()),i.getMonth()!==a?k(e,b(-1,t)):i}function B(e,t){const i=new Date(t.valueOf());return i.setFullYear(t.getFullYear()+e),i}function K(e){return`0${e.getDate().toString()}`.slice(-2)}function N(e){return`0${(e.getMonth()+1).toString()}`.slice(-2)}function H(e,t){return t==="yyyy"?e.getFullYear().toString():e.getFullYear().toString().slice(-2)}function _(e,t){const i=g(t);return t.split(i).map(r=>{switch(r[0]){case"d":return K(e);case"m":return N(e);case"y":return H(e,r)}}).join(i)}function u(e,t){const i=e[t];return!i||i==="/"?e[t-1]:i}function g(e){return e.match(/\W/)[0]}function q(e,t){const i=h(e),a=u(e,t.selectionStart),n=(i.indexOf(a)+i.length-1)%i.length,s=i[n];return c(e,s)}function G(e,t){const i=h(e),a=u(e,t.selectionStart),n=(i.indexOf(a)+1)%i.length,s=i[n];return c(e,s)}function h(e){const t=g(e);return e.split(t).reduce((i,a)=>i.concat(a[0]),[])}function c(e,t){const i=e.indexOf(t),a=e.lastIndexOf(t)+1;return{selectionStart:i,selectionEnd:a}}const J=":host{display:block}.gux-datepicker{display:inline-block}.gux-datepicker.gux-disabled{pointer-events:none;cursor:default}.gux-datepicker.gux-disabled .gux-datepicker-field .gux-datepicker-field-input{opacity:var(--gse-ui-datePicker-disabled-opacity)}.gux-datepicker .gux-datepicker-field{display:inline-flex;flex-direction:row;flex-wrap:nowrap;place-content:flex-start flex-start;align-items:center}.gux-datepicker .gux-datepicker-field~.gux-datepicker-field{margin-left:20px}.gux-datepicker .gux-datepicker-field.gux-above{flex-direction:column;align-items:self-start}.gux-datepicker .gux-datepicker-field.gux-above .gux-datepicker-field-input{margin-top:0}.gux-datepicker .gux-datepicker-field.gux-above .gux-datepicker-field-label{margin-right:0}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-label{flex:0 1 auto;align-self:auto;order:0;margin-right:var(--gse-ui-formControl-label-gap);font-size:var(--gse-ui-formControl-label-text-fontSize);font-weight:var(--gse-ui-formControl-label-text-fontWeight)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input{box-sizing:border-box;display:flex;flex-direction:row;flex-wrap:nowrap;gap:var(--gse-ui-formControl-input-gap);place-content:stretch center;align-items:center;width:100%;height:var(--gse-ui-formControl-input-textfield-height);padding:var(--gse-ui-formControl-input-padding);color:var(--gse-ui-formControl-input-populatedColor);white-space:nowrap;background-color:var(--gse-ui-formControl-input-backgroundColor);background-image:none;border:var(--gse-ui-formControl-input-default-border-width) var(--gse-ui-formControl-input-default-border-style) var(--gse-ui-formControl-input-default-border-color);border-radius:var(--gse-ui-formControl-input-borderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input:hover{border:var(--gse-ui-formControl-input-hover-border-width) var(--gse-ui-formControl-input-hover-border-style) var(--gse-ui-formControl-input-hover-border-color)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input:focus-within{border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius);outline:2px var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusRing-offset)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input.gux-active{border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius);outline:2px var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusRing-offset)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input{box-sizing:border-box;display:flex;flex-direction:row;flex-wrap:nowrap}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input{flex:1 1 auto;align-self:auto;order:0;width:calc(var(--gse-ui-calendarMenu-day-input-width) - var(--gse-ui-icon-size-sm));padding:0;overflow:hidden;font-family:var(--gse-ui-formControl-input-contentText-fontFamily);font-size:var(--gse-ui-formControl-input-contentText-fontSize);line-height:var(--gse-ui-formControl-input-contentText-lineHeight);color:var(--gse-ui-formControl-input-populatedColor);border:none;outline:none}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::placeholder{color:var(--gse-ui-formControl-input-placeholderColor);opacity:1}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-search-cancel-button,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-search-results-button,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-calendar-picker-indicator{display:none;-webkit-appearance:none}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button{display:flex;flex:0 1 auto;align-items:center;align-self:auto;justify-content:center;order:0;padding:0;color:var(--gse-ui-formControl-input-inputIcon-iconEndColor);background:transparent;border:none;border-radius:var(--gse-ui-actionButton-borderRadius);outline:none}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:focus-within{border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius);outline:2px var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusRing-offset);border:none;border-radius:var(--gse-ui-calendarMenu-month-calendarButton-focusBorderRadius);outline-offset:var(--gse-ui-datePicker-focusCalendar-gap)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):focus-visible,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):hover{color:var(--gse-ui-datePicker-iconHover);cursor:pointer}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button gux-icon{width:var(--gse-ui-icon-size-sm);height:var(--gse-ui-icon-size-sm)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input gux-calendar{position:fixed;z-index:var(--gse-semantic-zIndex-popup);display:none}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button{color:var(--gse-ui-formControl-input-inputIcon-iconEndColor)}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):focus-visible,.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):hover{color:var(--gse-ui-formControl-input-inputIcon-iconEndColor)}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input gux-calendar{display:block}.gux-sr-only{position:absolute;top:auto;left:-10000px;width:1px;height:1px;overflow:hidden}",Q=J;var X=function(e,t,i,a){var r=arguments.length,n=r<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,i):a,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(n=(r<3?s(n):r>3?s(t,i,n):s(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const y=class{constructor(e){F(this,e),this.input=D(this,"input",7),this.yearFormat="yyyy",this.isSelectingRangeWithMouse=!1,this.lastYear=new Date().getFullYear(),this.startInputId=f("gux-datepicker"),this.endInputId=f("gux-datepicker"),this.value=void 0,this.label="",this.numberOfMonths=1,this.startDayOfWeek=void 0,this.minDate="",this.maxDate="",this.mode="single",this.format=void 0,this.disabled=!1,this.labelPosition="beside",this.formattedValue="",this.minDateDate=void 0,this.maxDateDate=void 0,this.toFormattedValue="",this.active=!1,this.pressedKeys=[]}watchValue(){this.updateDate()}watchMinDate(e){e?this.minDateDate=d(e):this.minDateDate=null}watchMaxDate(e){e?this.maxDateDate=d(e):this.maxDateDate=null}watchFormat(e){e.includes("yyyy")||(this.yearFormat="yy"),this.intervalOrder=h(e),this.lastIntervalRange=this.initialIntervalRange}watchActiveCalendar(e){if(e===!0){const t=d(this.value.split("/")[0]);this.calendarElement.resetCalendarView(t)}}onKeyDown(e){if(this.isInputFieldEvent(e))switch(this.focusedField=this.getInputFieldFromEvent(e),e.key){case"Enter":case"Escape":this.focusedField.blur(),this.active=!1;break;case"Tab":break;case"ArrowDown":e.preventDefault(),this.increment(-1),this.setCursorRange();break;case"ArrowUp":e.preventDefault(),this.increment(1),this.setCursorRange();break;case"ArrowLeft":{e.preventDefault();const t=q(this.format,this.intervalRange);this.setIntervalRange(t),this.setCursorRange(),this.pressedKeys.length=0;break}case"ArrowRight":{e.preventDefault();const t=G(this.format,this.intervalRange);this.setIntervalRange(t),this.setCursorRange(),this.pressedKeys.length=0;break}default:e.preventDefault(),this.isSelectingRangeWithMouse||(this.setIntervalRange({selectionStart:this.focusedField.selectionStart,selectionEnd:this.focusedField.selectionEnd}),this.updateIntervalValue(e),this.setCursorRange());break}else switch(e.key){case"Enter":case"Escape":case" ":{this.active=!1;const t=this.root.shadowRoot.querySelector(".gux-calendar-toggle-button");p(()=>{t.focus()});break}case"Tab":this.active&&(this.active=!1);break}}onMouseDown(e){this.isInputFieldEvent(e)&&(this.isSelectingRangeWithMouse=!0);const t=e.composedPath(),i=t.includes(this.datepickerElement);Array.from(this.root.shadowRoot.querySelectorAll(".gux-calendar-toggle-button")).every(r=>!t.includes(r))&&(this.active=i)}onClickOutside(){this.active=!1,this.pressedKeys.length=0}onInputFocusIn(e){this.focusedField=this.getInputFieldFromEvent(e),this.isSelectingRangeWithMouse||p(()=>this.setRange())}onInputFocusOut(){this.lastIntervalRange=this.initialIntervalRange}onInputMouseUp(e){e.preventDefault(),this.lastIntervalRange=c(this.format,u(this.format,this.focusedField.selectionStart)),this.setRange(),this.isSelectingRangeWithMouse=!1}isInputFieldEvent(e){const t=e.composedPath();return t.includes(this.inputElement)||t.includes(this.toInputElement)}get initialIntervalRange(){return c(this.format,u(this.format,0))}getInputFieldFromEvent(e){return e.composedPath()[0]}updateIntervalValue(e){this.pressedKeys.push(e.key);const t=parseInt(e.key,10);if(!isNaN(t)){const i=this.focusedField.value.slice(this.focusedField.selectionStart,this.focusedField.selectionEnd);u(this.format,this.focusedField.selectionStart)==="y"&&this.yearFormat==="yyyy"?this.typeYearValue(i,e.key):this.canSetDate(t)&&this.pressedKeys.length>=2?(this.updateSelection(this.focusedField,`${i[1]}${e.key}`),this.setValue()):(this.updateSelection(this.focusedField,`0${e.key}`.replace("00","01")),this.setValue())}}updateSelection(e,t){e.value=e.value.substr(0,this.intervalRange.selectionStart)+t+e.value.substr(this.intervalRange.selectionEnd)}getCalendarLabels(){return $(this.label,this.mode,[this.i18n("start"),this.i18n("end"),this.i18n("date")])}stringToDate(e){const t=g(this.format),i=this.format.toLowerCase().split(t),a=e.split(t),r=parseInt(a[i.indexOf(this.yearFormat)],10),n=parseInt(a[i.indexOf("mm")],10)-1,s=parseInt(a[i.indexOf("dd")],10),l=new Date(r,n,s);return this.yearFormat==="yy"&&l.getFullYear()<1970&&this.lastYear>1970&&l.setFullYear(l.getFullYear()+100),l}onCalendarSelect(e){const t=e.target;this.value=t.value,e.stopPropagation(),this.input.emit(this.value),this.updateDate(),this.inputElement.value=this.formattedValue,this.mode==="range"&&(this.toInputElement.value=this.toFormattedValue),(document.activeElement!==this.inputElement||document.activeElement!==this.toInputElement)&&(this.active=!1)}setValue(){if(this.mode==="range"){const e=this.stringToDate(this.inputElement.value),t=this.stringToDate(this.toInputElement.value);this.value=m(e,t),this.updateDate(),this.calendarElement.setValue([e,t])}else{const e=this.stringToDate(this.inputElement.value);this.value=x(e),this.updateDate(),this.calendarElement.setValue(e)}this.input.emit(this.value)}setRange(){this.setIntervalRange(this.lastIntervalRange),this.setCursorRange()}typeYearValue(e,t){e[0]!==" "?this.updateSelection(this.focusedField,`   ${t}`):(this.updateSelection(this.focusedField,`${e.substr(1)}${t}`),(e.substr(1)+t).includes(" ")||this.setValue())}canSetDate(e){const t=parseInt([this.focusedField.value[this.intervalRange.selectionEnd-1].toString(),e].join(""),10);if(t)switch(u(this.format,this.focusedField.selectionStart)){case"d":{const i=d(this.value);if(t<=new Date(i.getFullYear(),i.getMonth()+1,0).getDate())return!0;break}case"m":if(t<=12)return!0;break;case"y":return!0}return!1}getMapAndRegexFromField(e){const t={dd:`0${e.getDate()}`.slice(-2),mm:`0${e.getMonth()+1}`.slice(-2)};this.yearFormat==="yyyy"?t.yyyy=e.getFullYear().toString():t.yy=e.getFullYear().toString().slice(-2);const i=new RegExp(Object.keys(t).join("|"),"gi");return{map:t,regexp:i}}updateDate(){if(this.mode==="range"){const[e,t]=v(this.value),{map:i,regexp:a}=this.getMapAndRegexFromField(e);this.formattedValue=this.format.replace(a,s=>i[s]);const{map:r,regexp:n}=this.getMapAndRegexFromField(t);this.toFormattedValue=this.format.replace(n,s=>r[s])}else{const e=d(this.value),{map:t,regexp:i}=this.getMapAndRegexFromField(e);this.formattedValue=this.format.replace(i,a=>t[a])}}setCursorRange(){this.intervalRange&&(this.focusedField.setSelectionRange(0,100),this.focusedField.setSelectionRange(this.intervalRange.selectionStart,this.intervalRange.selectionEnd))}toggleCalendar(){this.active=!this.active,this.active&&p(()=>{this.calendarElement.focusPreviewDate()})}setIntervalRange(e){this.intervalRange=e}getCombinedFocusedDateValue(){return this.mode==="range"?this.getRangeFocusedDateValue():this.getFocusedDateValue()}getFocusedDateValue(){return d(this.value)}getRangeFocusedDateValue(){const[e,t]=v(this.value);return this.focusedField===this.inputElement?e:t}increment(e){const t=u(this.format,this.focusedField.selectionStart),i=this.getCombinedFocusedDateValue();let a;switch(t){case"d":a=b(e,i);break;case"m":a=k(e,i);break;case"y":a=B(e,i);break}W(a,this.minDateDate,this.maxDateDate)&&(a=i),this.lastYear=a.getFullYear(),this.setIntervalRange({selectionStart:this.focusedField.selectionStart,selectionEnd:this.focusedField.selectionEnd}),this.focusedField.value=_(a,this.format),this.setValue()}async componentWillLoad(){if(M(this.root,{variant:this.mode}),this.i18n=await O(this.root,L),V()?this.format=this.format||P(Y(this.root)):this.format=this.format||"mm/dd/yyyy",this.watchMinDate(this.minDate),this.watchMaxDate(this.maxDate),this.watchFormat(this.format),!this.value){const e=new Date;e.setHours(0,0,0,0),this.mode==="range"?this.value=m(e,e):this.value=x(e),this.mode==="range"&&this.numberOfMonths<2&&(this.numberOfMonths=2)}this.updateDate()}runUpdatePosition(){this.cleanupUpdatePosition=C(this.datepickerElement,this.calendarElement,()=>this.updatePosition(),{ancestorScroll:!0,elementResize:!0,animationFrame:!0,ancestorResize:!0})}updatePosition(){w(this.datepickerElement,this.calendarElement,{strategy:"fixed",placement:"bottom-start",middleware:[R({crossAxis:-3}),S({fallbackStrategy:"initialPlacement"})]}).then(({x:e,y:t})=>{Object.assign(this.calendarElement.style,{left:`${e}px`,top:`${t}px`})})}componentDidUpdate(){this.active?this.runUpdatePosition():this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}disconnectedCallback(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}renderCalendarToggleButton(){return o("button",{class:"gux-calendar-toggle-button",type:"button",onClick:()=>this.toggleCalendar(),"aria-expanded":this.active.toString(),"aria-label":this.i18n("toggleCalendar"),disabled:this.disabled},o("gux-icon",{decorative:!0,"icon-name":"fa/calendar-regular"}))}renderCalendar(){return o("gux-calendar",{tabIndex:-1,ref:e=>this.calendarElement=e,value:this.value,mode:this.mode,onCalendarSelect:e=>this.onCalendarSelect(e),minDate:this.minDate,maxDate:this.maxDate,numberOfMonths:this.numberOfMonths,startDayOfWeek:this.startDayOfWeek})}renderStartDateField(){return o("div",{class:{"gux-datepicker-field":!0,"gux-above":this.labelPosition==="above"}},o("label",{htmlFor:this.startInputId,class:{"gux-datepicker-field-label":!0,"gux-sr-only":this.mode==="single"&&!this.label}},this.getCalendarLabels()[0]),o("div",{class:"gux-datepicker-field-input"},o("div",{class:"gux-datepicker-field-text-input"},o("input",{id:this.startInputId,type:"text",onClick:e=>this.onInputMouseUp(e),onFocusin:e=>this.onInputFocusIn(e),onFocusout:()=>this.onInputFocusOut(),ref:e=>this.inputElement=e,value:this.formattedValue,disabled:this.disabled}),this.renderCalendarToggleButton()),this.renderCalendar()))}renderEndDateField(){return this.mode==="single"?null:o("div",{class:{"gux-datepicker-field":!0,"gux-above":this.labelPosition==="above"}},o("label",{htmlFor:this.endInputId,class:"gux-datepicker-field-label"},this.getCalendarLabels()[1]),o("div",{class:"gux-datepicker-field-input"},o("div",{class:"gux-datepicker-field-text-input"},o("input",{id:this.endInputId,type:"text",ref:e=>this.toInputElement=e,onMouseUp:e=>this.onInputMouseUp(e),onFocusin:e=>this.onInputFocusIn(e),onFocusout:()=>this.onInputFocusOut(),value:this.toFormattedValue,disabled:this.disabled}),this.renderCalendarToggleButton())))}render(){return o("div",{key:"1c33a3aca622516c61cbdd4d5bac4242cfbad49c",class:{"gux-datepicker":!0,"gux-active":this.active,"gux-disabled":this.disabled},ref:e=>this.datepickerElement=e},this.renderStartDateField(),this.renderEndDateField())}get root(){return I(this)}static get watchers(){return{value:["watchValue"],minDate:["watchMinDate"],maxDate:["watchMaxDate"],format:["watchFormat"],active:["watchActiveCalendar"]}}};X([E({triggerEvents:"mousedown"})],y.prototype,"onClickOutside",null);y.style=Q;export{y as gux_datepicker};
