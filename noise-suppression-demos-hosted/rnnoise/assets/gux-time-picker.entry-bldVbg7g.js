import{r as S,h as u,g as T}from"./index-RhTaIPoL.js";import{O as A}from"./on-click-outside-C-8pG9cs-6YGsTWW7.js";import{s as g}from"./simulate-native-event-BMRf5pjV-BcLDngo1.js";import{b as $}from"./after-next-render-Bg4q97BS-C_KTwidI.js";import{b as E,g as O}from"./index-Bbwiw1Rf-CzeU2kBB.js";import{t as B}from"./usage-BYFiy2rf-lhiVWKSr.js";import{a as k}from"./log-error-DxtJDeL9-5foDqi4E.js";import{a as h}from"./spark-intl-CJJbLxeY-BrpETJ5c.js";import{u as d}from"./use-regional-dates-BgaA4g76-C5bTvd2o.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";import"./get-closest-element-DCZG2J0G-kuMVup89.js";const V="AM",F="Toggle suggested times",L="Input hours",M="Input minutes",R="PM",H="Time options open: {state}",z="{amOrPm} selected, click to toggle";var K={am:V,"time-separator":":",clockButton:F,hoursInput:L,minutesInput:M,pm:R,timeOptionsState:H,toggleAmPM:z};function _(e,t,i,r){const o=[0,15,30,45].filter(s=>Number.isInteger(s/e)).map(s=>String(s).padStart(2,"0")),a=(t==="12h"?["12","01","02","03","04","05","06","07","08","09","10","11"]:Array.from(Array(24).keys()).map(s=>String(s).padStart(2,"0"))).reduce((s,c)=>s.concat(o.map(m=>`${c}:${m}`)),[]);return t==="24h"?j(a,i,r):a}function j(e,t,i){return t&&i&&l(t)>l(i)?e=e.filter(r=>{const o=l(r),n=l(t),a=l(i),s=l("23:59");return o>=n&&o<s||o<=a}):(t&&(e=e.filter(r=>l(r)>=l(t))),i&&(e=e.filter(r=>l(r)<=l(i)))),e}function l(e){const t=new Date,[i,r]=e.split(":");return t.setHours(parseFloat(i)),t.setMinutes(parseFloat(r)),t.setSeconds(0),t.getTime()}function N(e){let t;d()?t=h(e).toLowerCase():t=O(e).toLowerCase();const i=new Date("January 19, 1975 15:00:00 UTC+00:00"),r=new Intl.DateTimeFormat(t,{timeStyle:"short",timeZone:"UTC"}).format(i);return!d()&&["ar","ko","zh-cn","zh-tw"].some(n=>t.startsWith(n))||r.includes("15")?"24h":"12h"}function f(e,t){const[i,r]=e.split(":");return`${((parseInt(i,10)+t+24)%24).toString().padStart(2,"0")}:${r}`}function w(e,t,i){const[r,o]=e.split(":");let a=(parseInt(o,10)+t+60)%60;for(;a%i!==0;)a=(a+t+60)%60;const s=a.toString().padStart(2,"0");return`${r}:${s}`}function C(e,t){const[i,r]=e.split(":");return t==="12h"?`${(parseInt(i,10)%12||12).toString().padStart(2,"0")}:${r}`:`${i}:${r}`}function b(e,t,i){const[r,o]=e.split(":");return t==="12h"?i?`${(parseInt(r,10)%12).toString().padStart(2,"0")}:${o}`:`${(parseInt(r,10)%12+12).toString().padStart(2,"0")}:${o}`:`${r}:${o}`}function v(e,t){const[i]=C(e,t).split(":");return i}function x(e){const[,t]=e.split(":");return t}function p(e){const[t]=e.split(":");return parseInt(t,10)<12}function I(e){return e==="12h"?"^(0?[1-9]|1[012])$":"^([01]?[0-9]|2[0-3])$"}function P(){return"^[0-5][0-9]$"}function W(e,t,i,r,o){const[n,a]=C(e,t).split(":");let s=n;return i==="Backspace"?t=="12h"&&o==1?s=s.split("").filter((c,m)=>m==r-1).join(""):s=s.split("").filter((c,m)=>m!==r-1).join("").padStart(2,"0"):s=parseInt(s.slice(0,r)+i+s.slice(r+1),10).toString().slice(-2).padStart(2,"0"),new RegExp(I(t)).test(s)||(t==="12h"?s=i:s=i.padStart(2,"0")),b(`${s}:${a}`,t,p(e))}function U(e,t,i){const[r,o]=e.split(":");let n=o;return t==="Backspace"?n=n.split("").filter((a,s)=>s!==i-1).join("").padStart(2,"0"):n=(n.slice(0,i)+t+n.slice(i+1)).slice(-2).padStart(2,"0"),new RegExp(P()).test(n)||(n=t.padStart(2,"0")),`${r}:${n}`}function y(e){var t,i,r,o;const n=new Intl.DateTimeFormat(e,{hour:"numeric",minute:"2-digit",hour12:!0}),a=n.formatToParts(new Date(2020,0,1,9,0)),s=n.formatToParts(new Date(2020,0,1,21,0));return{am:(i=(t=a.find(c=>c.type==="dayPeriod"))===null||t===void 0?void 0:t.value)!==null&&i!==void 0?i:"AM",pm:(o=(r=s.find(c=>c.type==="dayPeriod"))===null||r===void 0?void 0:r.value)!==null&&o!==void 0?o:"PM"}}function q(e){const r=new Intl.DateTimeFormat(e,{hour:"numeric",minute:"2-digit",hour12:!0}).formatToParts(new Date(2020,0,1,9,30)).map(a=>a.type),o=r.indexOf("dayPeriod"),n=r.indexOf("hour");return o<0?"none":o<n?"before":"after"}const G=".gux-time-picker{position:relative;display:inline-block}.gux-time-picker.gux-error .gux-input-time{border-color:var(--gse-ui-formControl-input-error-border-color)}.gux-time-picker .gux-input-time{box-sizing:border-box;display:flex;flex-direction:row;flex-wrap:nowrap;gap:var(--gse-ui-formControl-input-gap);place-content:stretch center;align-items:center;inline-size:100%;block-size:var(--gse-ui-formControl-input-textfield-height);padding:var(--gse-ui-formControl-input-padding);font-family:var(--gse-ui-formControl-input-contentText-fontFamily);font-size:var(--gse-ui-formControl-input-contentText-fontSize);line-height:var(--gse-ui-formControl-input-contentText-lineHeight);color:var(--gse-ui-formControl-input-populatedColor);white-space:nowrap;background-color:var(--gse-ui-formControl-input-backgroundColor);background-image:none;border:var(--gse-ui-formControl-input-default-border-width) var(--gse-ui-formControl-input-default-border-style) var(--gse-ui-formControl-input-default-border-color);border-radius:var(--gse-ui-formControl-input-borderRadius)}.gux-time-picker .gux-input-time:focus-within{outline:var(--gse-semantic-focusOutline-md-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset)}.gux-time-picker .gux-input-time:hover:not(:disabled){border:var(--gse-ui-formControl-input-hover-border-width) var(--gse-ui-formControl-input-hover-border-style) var(--gse-ui-formControl-input-hover-border-color)}.gux-time-picker .gux-input-time input{flex:1 1 auto;align-self:auto;order:0;inline-size:2ch;padding:0;font-size:var(--gse-ui-formControl-label-text-fontSize);color:var(--gse-ui-formControl-input-populatedColor);outline:none;background-color:var(--gse-ui-formControl-input-backgroundColor);border:none}.gux-time-picker .gux-input-time input.gux-input-time-hours{text-align:end}.gux-time-picker .gux-input-time input::placeholder{color:var(--gse-ui-formControl-input-placeholderColor);opacity:1}.gux-time-picker .gux-input-time .gux-input-time-am-pm-selector{display:grid;grid-template:auto 1fr/auto 1fr auto;place-items:flex-end;padding:0;font-family:var(--gse-ui-formControl-input-prefixSufix-text-fontFamily);font-size:var(--gse-ui-formControl-input-prefixSufix-text-fontSize);font-weight:var(--gse-ui-formControl-input-prefixSufix-text-fontWeight);line-height:var(--gse-ui-formControl-input-prefixSufix-text-lineHeight);color:var(--gse-ui-formControl-input-populatedColor);outline:none;background:transparent;border:none}.gux-time-picker .gux-input-time .gux-input-time-am-pm-selector:focus-visible{outline:var(--gse-semantic-focusOutline-md-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset);border-radius:var(--gse-ui-timePicker-focusAmpm-borderRadius)}.gux-time-picker .gux-input-time .gux-input-time-am-pm-selector .gux-meridiem{display:none;grid-row:1/1;grid-column:1/1}.gux-time-picker .gux-input-time .gux-input-time-am-pm-selector .gux-meridiem.gux-visible{display:inline-block}.gux-time-picker .gux-input-time .gux-clock-button{display:flex;flex:0 1 auto;align-items:center;align-self:auto;justify-content:center;order:0;padding:0;color:var(--gse-ui-formControl-input-inputIcon-iconEndColor);outline:none;background:transparent;border:none}.gux-time-picker .gux-input-time .gux-clock-button.gux-active:not(:disabled){color:var(--gse-ui-timePicker-clockStates-activeColor);cursor:pointer}.gux-time-picker .gux-input-time .gux-clock-button:focus-visible{outline:var(--gse-semantic-focusOutline-md-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset);border-radius:var(--gse-ui-timePicker-focusClock-borderRadius)}.gux-time-picker .gux-input-time .gux-clock-button gux-icon{padding:var(--gse-ui-timePicker-clock-padding)}.gux-time-picker .gux-time-separator{padding-block:0;padding-inline:1ch}.gux-time-picker .gux-list-container{max-block-size:150px;margin:0;overflow-y:auto;background:var(--gse-ui-menu-backgroundColor);border-color:var(--gse-ui-menu-border-color);border-style:var(--gse-ui-menu-border-style);border-width:var(--gse-ui-menu-border-width);border-radius:var(--gse-ui-menu-borderRadius);box-shadow:var(--gse-ui-menu-boxShadow)}";var J=function(e,t,i,r){var o=arguments.length,n=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n};const D=class{constructor(e){S(this,e),this.value="00:00",this.interval=60,this.step=1,this.disabled=!1,this.required=!1,this.hasError=!1,this.expanded=!1}onFocus(){this.valueLastChange=this.value}onBlur(){this.valueLastChange!==this.value&&g(this.root,"change")}onClickOutside(){this.expanded=!1}handleKeydown(e){switch(e.key){case"Escape":case"Tab":this.expanded=!1;break}}async componentWillLoad(){B(this.root),this.i18n=await E(this.root,K),this.clockType=this.clockType||N(this.root),this.validateValueFormat(this.value,"00:00"),this.clockType=="12h"&&(this.min||this.max)&&k(this.root,'clock type must be "24h" when using min/max props')}validateValueFormat(e,t){this.isValidTimeFormat(e)||(k(this.root,`"${e}" is not a valid value format. Format must be "hh:mm" or "h:mm". Falling back to previous value: "${t}"`),this.value=t)}isValidTimeFormat(e){return typeof e=="string"&&/^\d{1,2}:\d{2}$/.test(e)}updateValue(e,t=!1){e!==this.value&&(this.value=e,g(this.root,"input"),t&&this.valueLastChange!==this.value&&(g(this.root,"change"),this.valueLastChange=this.value))}valueToId(e){return`gux-id-${e.replace(":","-")}`}focusRelevantItemInPopupList(){$(()=>{this.listElement.guxFocusItemByClosestId(this.valueToId(this.value))})}toggleDropdown(){this.expanded=!this.expanded,this.expanded&&this.focusRelevantItemInPopupList()}onTargetClick(e){const t=e.composedPath(),i=t.includes(this.clockButton),r=t.includes(this.amPmElement),o=t.includes(this.hourInputElement),n=t.includes(this.minuteInputElement);!i&&!r&&!n&&!o&&this.toggleDropdown()}handleClickDropdownValue(e){const t=b(e,this.clockType,p(this.value));this.updateValue(t,!0),this.clockButton.focus(),this.expanded=!1}onHourKeyDown(e){switch(e.key){case"Tab":case"ArrowLeft":case"ArrowRight":case"Escape":break;case"ArrowDown":e.preventDefault(),this.updateValue(f(this.value,-1));break;case"ArrowUp":e.preventDefault(),this.updateValue(f(this.value,1));break;case"Backspace":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e.preventDefault(),this.hourInputElement.setSelectionRange(2,2),this.updateValue(W(this.value,this.clockType,e.key,this.hourInputElement.selectionStart,this.hourInputElement.value.length));break;default:e.preventDefault()}}onMinuteKeyDown(e){switch(e.key){case"Tab":case"ArrowLeft":case"ArrowRight":case"Escape":break;case"ArrowDown":e.preventDefault(),this.updateValue(w(this.value,-1,this.step));break;case"ArrowUp":e.preventDefault(),this.updateValue(w(this.value,1,this.step));break;case"Backspace":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{e.preventDefault(),this.minuteInputElement.setSelectionRange(2,2),this.updateValue(U(this.value,e.key,this.minuteInputElement.selectionStart));break}default:e.preventDefault()}}onAmPmButtonKeyDown(e){switch(e.key){case"ArrowDown":case"ArrowUp":this.toggleAmPm(e);break}}onListKeyDown(e){switch(e.key){case"Escape":this.expanded=!1,this.clockButton.focus();break}}toggleAmPm(e){e.preventDefault(),this.updateValue(f(this.value,12),!0)}getAmPmString(){return p(this.value)?this.i18n("am"):this.i18n("pm")}renderNumberInput(){return u("div",{class:"gux-input-time-container"},u("input",{role:"spinbutton",class:"gux-input-time-hours",type:"text",disabled:this.disabled,value:v(this.value,this.clockType),onKeyDown:e=>this.onHourKeyDown(e),"aria-label":this.i18n("hoursInput"),pattern:I(this.clockType),ref:e=>this.hourInputElement=e,"aria-valuetext":v(this.value,this.clockType),"aria-valuenow":v(this.value,this.clockType),"aria-valuemin":this.clockType==="24h"?0:1,"aria-valuemax":this.clockType==="24h"?23:12}),u("span",{class:"gux-time-separator"},this.i18n("time-separator")),u("input",{role:"spinbutton",class:"gux-input-time-minutes",type:"text",disabled:this.disabled,value:x(this.value),onKeyDown:e=>this.onMinuteKeyDown(e),"aria-label":this.i18n("minutesInput"),pattern:P(),ref:e=>this.minuteInputElement=e,"aria-valuetext":x(this.value),"aria-valuenow":x(this.value),"aria-valuemin":0,"aria-valuemax":59}))}renderAmPmBefore(){return!!(d()&&q(h(this.root))==="before")}renderAmString(){return d()?u("span",null,y(h(this.root)).am):u("span",null,this.i18n("am"))}renderPmString(){return d()?u("span",null,y(h(this.root)).pm):u("span",null,this.i18n("pm"))}renderAmPmSelector(){if(this.clockType==="12h")return u("button",{class:"gux-input-time-am-pm-selector",type:"button",disabled:this.disabled,"aria-label":this.i18n("toggleAmPM",{amOrPm:this.getAmPmString()}),onClick:e=>this.toggleAmPm(e),onKeyDown:e=>this.onAmPmButtonKeyDown(e),ref:e=>this.amPmElement=e},u("div",{class:{"gux-meridiem":!0,"gux-visible":p(this.value)}},this.renderAmString()),u("div",{class:{"gux-meridiem":!0,"gux-visible":!p(this.value)}},this.renderPmString()))}renderClockButton(){return u("button",{class:{"gux-clock-button":!0,"gux-active":this.expanded},type:"button",disabled:this.disabled,"aria-label":this.i18n("clockButton"),"aria-expanded":this.expanded.toString(),onClick:this.toggleDropdown.bind(this),ref:e=>this.clockButton=e},u("gux-icon",{decorative:!0,"icon-name":"fa/clock-regular",size:"small"}))}renderTimeListItems(){return _(this.interval,this.clockType,this.min,this.max).map(e=>{const t=b(e,this.clockType,p(this.value));return u("gux-list-item",{id:this.valueToId(t),onClick:()=>this.handleClickDropdownValue(e)},e)})}renderTarget(){return u("div",{class:"gux-input-time",slot:"target",onClick:this.onTargetClick.bind(this)},this.renderTargetContent())}renderTargetContent(){return this.renderAmPmBefore()?[this.renderAmPmSelector(),this.renderNumberInput(),this.renderClockButton()]:[this.renderNumberInput(),this.renderAmPmSelector(),this.renderClockButton()]}renderPopup(){return u("div",{slot:"popup",class:"gux-list-container",onKeyDown:e=>this.onListKeyDown(e)},u("gux-list",{ref:e=>this.listElement=e},this.renderTimeListItems()))}render(){return u("gux-popup",{key:"c6d239b99da2808d5833b489b29411680f6048d5",class:{"gux-time-picker":!0,"gux-error":this.hasError},expanded:this.expanded,disabled:this.disabled},this.renderTarget(),this.renderPopup())}get root(){return T(this)}static get watchers(){return{value:["validateValueFormat"]}}};J([A({triggerEvents:"mousedown"})],D.prototype,"onClickOutside",null);D.style=G;export{D as gux_time_picker};
