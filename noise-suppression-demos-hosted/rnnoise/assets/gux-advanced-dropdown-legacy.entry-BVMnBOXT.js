import{r as u,c as d,h as o,g as p}from"./index-RhTaIPoL.js";import{o as h}from"./on-mutation-CF55kYjc-BUuUxYmY.js";import{O as f}from"./on-click-outside-C-8pG9cs-6YGsTWW7.js";import{a as g}from"./after-next-render-Bg4q97BS-C_KTwidI.js";import{t as x}from"./usage-BYFiy2rf-lhiVWKSr.js";import{b}from"./index-Bbwiw1Rf-CzeU2kBB.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";const w="Search";var m={searchAria:w};const v=":host{color:#2e394c}gux-popup{display:block;margin:4px 0}gux-popup .gux-select-field{position:relative;width:100%;height:32px}gux-popup .gux-select-field a.gux-select-input{position:absolute;inset:0;padding:6px 24px 6px 12px;overflow:hidden;text-overflow:ellipsis;color:#2e394c;white-space:nowrap;text-decoration:none;cursor:pointer;background-color:#f6f7f9;background-image:none;border:1px solid #6b7585;border-radius:4px;box-shadow:inset 0 0 4px rgba(32, 41, 55, 0.16)}gux-popup .gux-select-field a.gux-select-input .gux-select-placeholder,gux-popup .gux-select-field a.gux-select-input .gux-select-value{line-height:20px}gux-popup .gux-select-field a.gux-select-input .gux-select-placeholder{color:#596373}gux-popup .gux-select-field a.gux-select-input:focus-visible{outline:var(--gse-semantic-focusOutline-md-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset)}gux-popup .gux-select-field .gux-icon-wrapper gux-icon{width:16px;height:16px;color:#596373}gux-popup .gux-select-field .gux-icon-wrapper{position:absolute;top:1px;right:8px;bottom:0;display:flex;align-items:center;overflow:hidden;cursor:pointer}gux-popup .gux-select-field:hover .gux-icon-wrapper gux-icon{color:#2e394c}gux-popup .gux-advanced-dropdown-menu{background:#fdfdfd;border:1px solid #b4bccb;border-radius:4px;box-shadow:0 0 2px 0 rgba(32, 41, 55, 0.24)}gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search{margin:8px 16px}gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-search-cancel-button,gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-search-results-button,gux-popup .gux-advanced-dropdown-menu .gux-dropdown-menu-container gux-form-field-search input::-webkit-calendar-picker-indicator{display:none;-webkit-appearance:none}gux-popup .gux-dropdown-options{padding:8px 0;margin:0;overflow-y:auto;color:#2e394c;background:#fdfdfd;border-radius:4px;box-shadow:none}";var y=function(e,t,s,n){var r=arguments.length,i=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,s):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,s,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(i=(r<3?a(i):r>3?a(t,s,i):a(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};const l=class{constructor(e){u(this,e),this.input=d(this,"input",7),this.filter=d(this,"filter",7),this.disabled=!1,this.noFilter=!1,this.filterDebounceTimeout=500,this.dropdownHeight="320px"}watchValue(e){this.opened&&e&&this.closeDropdown(!1)}get value(){var e;return(e=this.currentlySelectedOption)===null||e===void 0?void 0:e.text}getSelectedValues(){return Promise.resolve([this.value])}async setLabeledBy(e){this.srLabelledby=e}onClickOutside(){this.closeDropdown(!1)}async componentWillLoad(){x(this.root),this.i18n=await b(this.root,m),this.handleSelectionChange=this.handleSelectionChange.bind(this),this.updateSelectionState(),this.addOptionListener(),this.slotObserver=h(this.root,()=>this.updateSelectionState())}disconnectedCallback(){this.slotObserver&&this.slotObserver.disconnect()}render(){return o("gux-popup",{key:"fbb2bbea72c3a3f674db632f033d47b777352b3e",expanded:this.opened,disabled:this.disabled},o("div",{key:"48cfa429402a703123a866450079d800af786c7a",slot:"target",class:"gux-select-field",onMouseDown:()=>this.inputMouseDown()},o("a",{key:"f99bcb470c3e144500fda080ca4ff9f29344745e",ref:e=>this.inputBox=e,class:"gux-select-input","aria-labelledby":this.srLabelledby,tabindex:"0",onKeyDown:e=>this.inputKeyDown(e)},this.placeholder&&!this.value&&o("span",{key:"96374c196aab30d1734d2b90b3107ea254f699d5",class:"gux-select-placeholder",title:this.placeholder},this.placeholder),this.value&&o("span",{key:"f8cdaa2ae3b1e4ed0d4fd64f58203f7d6a1b9286",class:"gux-select-value",title:this.value},this.value)),o("div",{key:"81d19c062c244d1fc58e7a837f58d46585807cde",class:"gux-icon-wrapper"},o("gux-icon",{key:"b0b8a1bb26053838f54be1ec14f66f873688c156",decorative:!0,"icon-name":"custom/chevron-down-small-regular"}))),o("div",{key:"d33d13d1375b71693eed053386a821b3a0f4da9a",slot:"popup",class:"gux-advanced-dropdown-menu"},o("div",{key:"aca41652db6b5db02612a68e9d5a361e73657526",class:"gux-dropdown-menu-container"},o("gux-form-field-search",{key:"b81168a863cadffa98dd8c312b2806e73edfad20","label-position":"screenreader"},o("label",{key:"fc1da752136a6e5fa91a08aec0ebb9acb05d23af",slot:"label"},this.i18n("searchAria")),o("input",{key:"095263323522aca42a4662e8dbc474c4b935aaf6",slot:"input",type:"search",onInput:e=>{this.handleSearchInput(e)},ref:e=>this.searchInput=e})),o("div",{key:"68913b9969bcecb53e73d8b16e8fa6cb4d95e62f",class:"gux-dropdown-options",style:{maxHeight:this.dropdownHeight},onKeyDown:e=>this.optionsKeyDown(e)},o("slot",{key:"5e27527e46815055e608a4b5aa728170612b4785"})))))}updateSelectionState(){this.selectionOptions=this.getSelectionOptions(),this.currentlySelectedOption=this.selectionOptions.find(e=>e.selected)}addOptionListener(){this.root.addEventListener("selectedChanged",e=>this.handleSelectionChange(e))}handleSelectionChange({target:e}){const t=e;this.closeDropdown(!0),this.currentlySelectedOption!==t&&(this.currentlySelectedOption&&(this.currentlySelectedOption.selected=!1),this.currentlySelectedOption=t,this.input.emit(t.value))}getSelectionOptions(){const e=this.root.querySelectorAll("gux-dropdown-option");return Array.from(e)}inputMouseDown(){this.disabled||(this.opened?this.closeDropdown(!0):this.openDropdown(!1))}getFocusIndex(){return this.selectionOptions.findIndex(e=>e.matches(":focus"))}optionsKeyDown(e){switch(e.key){case"ArrowUp":{e.preventDefault();const t=this.getFocusIndex();t>0&&this.selectionOptions[t-1].focus();break}case"ArrowDown":{e.preventDefault();const t=this.getFocusIndex();t<this.selectionOptions.length-1&&this.selectionOptions[t+1].focus();break}case"Home":if(!this.selectionOptions.length)return;this.selectionOptions[0].focus();break;case"End":if(!this.selectionOptions.length)return;this.selectionOptions[this.selectionOptions.length-1].focus();break}}inputKeyDown(e){switch(e.key){case"ArrowUp":case"ArrowDown":case" ":this.openDropdown(!0);break}}handleSearchInput(e){e.stopPropagation(),clearTimeout(this.filterDebounceTimer),this.filterDebounceTimer=setTimeout(()=>this.searchRequested(),this.filterDebounceTimeout)}searchRequested(){const e=this.searchInput.value;this.filter.emit(e),this.setFilteredOptions()}setFilteredOptions(){const e=this.searchInput.value;if(!this.noFilter)for(const t of this.selectionOptions)t.shouldFilter(e).then(s=>{t.filtered=s})}changeFocusToSearch(){g(()=>{this.searchInput.focus()})}openDropdown(e){this.opened=!0,e&&this.changeFocusToSearch()}closeDropdown(e){this.opened=!1,this.searchInput.value="",this.setFilteredOptions(),e&&this.inputBox.focus()}get root(){return p(this)}static get watchers(){return{disabled:["watchValue"]}}};y([f({triggerEvents:"mousedown"})],l.prototype,"onClickOutside",null);l.style=v;export{l as gux_advanced_dropdown_legacy};
