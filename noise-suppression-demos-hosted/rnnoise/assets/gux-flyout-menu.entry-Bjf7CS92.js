import{r as h,h as t,H as f,g as m}from"./index-RhTaIPoL.js";import{a as p,c as g,o as b,f as y,s as w,b as x}from"./floating-ui.dom-s4o__4X6-DwnQVfa1.js";import{a as i}from"./after-next-render-Bg4q97BS-C_KTwidI.js";import{t as v}from"./usage-BYFiy2rf-lhiVWKSr.js";import{h as k}from"./gux-menu.common-QGDBFOq1-CC6R-ieU.js";import{b as E}from"./index-Bbwiw1Rf-CzeU2kBB.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";const M="Use the right arrow to enter the submenu, and the left arrow to return to the previous menu",P="A popup has appeared. Press the down arrow to enter the menu";var C={onMenuFocus:M,onTargetFocus:P};const F=":host{z-index:var(--gse-semantic-zIndex-popover);color:var(--gse-ui-menu-option-label-foregroundColor);cursor:default}:host(:focus){outline:none}:host(:focus-visible){outline:var(--gse-semantic-focusOutline-md-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset)}.gux-flyout-menu-content{position:fixed;display:none;border:none;border-radius:var(--gse-ui-flyoutMenu-borderRadius);box-shadow:var(--gse-ui-menu-boxShadow);opacity:0}.gux-flyout-menu-content.gux-shown{display:flex;animation-name:fade-in;animation-duration:100ms;animation-delay:350ms;animation-fill-mode:forwards}.gux-flyout-menu-content .gux-arrow{position:absolute;inline-size:var(--gse-ui-flyoutMenu-anchor-width);block-size:var(--gse-ui-flyoutMenu-anchor-height);padding-block-end:4px;overflow:hidden}.gux-flyout-menu-content .gux-arrow-caret{inline-size:0;block-size:0;border-block-start:var(--gse-ui-flyoutMenu-anchor-borderWidth) solid var(--gse-ui-flyoutMenu-backgroundColor);border-inline-start:var(--gse-ui-flyoutMenu-anchor-borderWidth) solid transparent;border-inline-end:var(--gse-ui-flyoutMenu-anchor-borderWidth) solid transparent;filter:drop-shadow(0 0 4px var(--gse-ui-flyoutMenu-anchor-shadowColor))}@keyframes fade-in{0%{opacity:0}100%{opacity:1}}",U=class{constructor(e){h(this,e),this.isShown=!1}onKeydown(e){if(e.stopPropagation(),this.isShown)switch(e.key){case"Escape":case"ArrowLeft":case"ArrowUp":this.root.focus();return;case"ArrowDown":e.preventDefault(),this.focusOnMenu();return;case"Enter":this.hideDelayTimeout=i(()=>{this.focusOnMenu()});return}}onKeyup(e){switch(e.stopPropagation(),e.key){case" ":this.root===e.target?this.focusOnMenu():this.hideDelayTimeout=i(()=>{this.root.focus()});return}}onmouseenter(){this.show()}onMouseleave(){this.hide()}onClick(e){e.detail!==0&&this.hide(),this.root.focus()}onFocusin(){this.isShown||this.announceElement.guxAnnounce(this.i18n("onTargetFocus")),this.show()}onFocusout(){this.hide()}show(){clearTimeout(this.hideDelayTimeout),this.isShown=!0}hide(){this.isShown&&(this.hideDelayTimeout=setTimeout(()=>{this.isShown=!1},k))}runUpdatePosition(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition(),this.root.isConnected?this.cleanupUpdatePosition=p(this.targetElement,this.menuContentElement,()=>this.updatePosition(),{ancestorScroll:!0,elementResize:!0,animationFrame:!0,ancestorResize:!0}):this.disconnectedCallback()}updatePosition(){this.root&&g(this.targetElement,this.menuContentElement,{placement:"bottom-start",strategy:"fixed",middleware:[b(16),y(),w(),x({element:this.arrowElement,padding:16})]}).then(({x:e,y:s,middlewareData:o,placement:c})=>{var n;Object.assign(this.menuContentElement.style,{left:`${e}px`,top:`${s}px`});const a=c.split("-")[0],l={top:"bottom",right:"left",bottom:"top",left:"right"}[a],d={top:0,right:90,bottom:180,left:-90}[a];if(o.arrow){const{x:r,y:u}=o.arrow;Object.assign((n=this.arrowElement)===null||n===void 0?void 0:n.style,{left:r!=null?`${r}px`:"",top:u!=null?`${u}px`:"",right:"",bottom:"",[l]:"-12px",transform:`rotate(${d}deg)`})}})}focusOnMenu(){if(this.menuContentElement.contains(document.activeElement))return;this.hideDelayTimeout=i(()=>{this.announceElement.guxAnnounce(this.i18n("onMenuFocus"))});const e=this.root.querySelector("gux-menu");Array.from(e.children)[0].guxFocus()}async componentWillLoad(){v(this.root),this.i18n=await E(this.root,C)}componentDidLoad(){this.isShown&&this.runUpdatePosition()}componentDidUpdate(){this.isShown?this.runUpdatePosition():this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}disconnectedCallback(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}render(){return t(f,{key:"f0fa299afefecd0aa2e22bca26314d8cd9979542",tabIndex:0,"aria-haspopup":"true"},t("gux-announce-beta",{key:"ab28aaff478274f8b04092ae1fa059b6a9a73935",ref:e=>this.announceElement=e}),t("span",{key:"b39d68fadbddfd87a7e81467a0e5c967394c15bc",ref:e=>this.targetElement=e},t("slot",{key:"496e0dd8f6f11a0aafca2ee372e61a37d86b2e3e",name:"target"})),t("div",{key:"e255adc47f8a87d8b1c88b60f2d5132d88340a12",class:{"gux-flyout-menu-content":!0,"gux-shown":this.isShown},ref:e=>this.menuContentElement=e},t("div",{key:"c396e683a2c9734e34cab25d86442434bc621689",ref:e=>this.arrowElement=e,class:"gux-arrow"},t("div",{key:"0ef6b56bc494fb376c357cd922d16209f9427beb",class:"gux-arrow-caret"})),t("slot",{key:"87141a4531e7df4abf951bb75c6aa520a38f6736",name:"menu"})))}get root(){return m(this)}};U.style=F;export{U as gux_flyout_menu};
