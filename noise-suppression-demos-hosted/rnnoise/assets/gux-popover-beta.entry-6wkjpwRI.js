import{r as m,c as g,h as s,g as v}from"./index-RhTaIPoL.js";import{a as b,c as E,o as x,f as w,s as k,h as y,b as P}from"./floating-ui.dom-s4o__4X6-DwnQVfa1.js";import{O}from"./on-click-outside-C-8pG9cs-6YGsTWW7.js";import{t as C}from"./usage-BYFiy2rf-lhiVWKSr.js";import{g as u}from"./get-slot-BBpQG81s-DJNt4BpD.js";import{f as c}from"./find-element-by-id-Cr5bTKWF-DntMpzyb.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";const F=":popover-open{position:absolute;inset:unset}.gux-popover-wrapper{position:absolute;inset-block-start:0;inset-inline-start:0;padding:var(--gse-ui-popover-padding);overflow:hidden;color:var(--gse-semantic-foreground-container-highEmphasis);background-color:var(--gse-ui-popover-backgroundColor);border:none;border-radius:var(--gse-ui-popover-borderRadius);box-shadow:var(--gse-ui-popover-boxShadow)}.gux-popover-wrapper .gux-arrow{position:absolute;inline-size:var(--gse-ui-popover-anchor-width);block-size:var(--gse-ui-popover-anchor-height);padding-block-end:4px;overflow:hidden}.gux-popover-wrapper{}.gux-popover-wrapper .gux-arrow-caret{inline-size:0;block-size:0;border-block-start:calc(var(--gse-ui-popover-anchor-width) / 2) solid var(--gse-ui-popover-backgroundColor);border-inline-start:calc(var(--gse-ui-popover-anchor-width) / 2) solid transparent;border-inline-end:calc(var(--gse-ui-popover-anchor-width) / 2) solid transparent;filter:drop-shadow(0 0 4px var(--gse-semantic-effects-boxShadow))}.gux-popover-wrapper .gux-popover-header{display:flex;flex-direction:row;place-content:center space-between;align-items:center;padding-block-end:var(--gse-ui-popover-gap);font-family:var(--gse-ui-popover-title-text-fontFamily);font-size:var(--gse-ui-popover-title-text-fontSize);font-weight:var(--gse-ui-popover-title-text-fontWeight);line-height:var(--gse-ui-popover-title-text-lineHeight);color:var(--gse-ui-popover-headerColor)}.gux-popover-wrapper .gux-popover-footer{padding-block-start:var(--gse-ui-popover-gap)}";var U=function(e,o,r,i){var n=arguments.length,t=n<3?o:i===null?i=Object.getOwnPropertyDescriptor(o,r):i,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(e,o,r,i);else for(var a=e.length-1;a>=0;a--)(p=e[a])&&(t=(n<3?p(t):n>3?p(o,r,t):p(o,r))||t);return n>3&&t&&Object.defineProperty(o,r,t),t};const h=class{constructor(e){m(this,e),this.guxdismiss=g(this,"guxdismiss",7),this.position="bottom",this.displayDismissButton=!1,this.closeOnClickOutside=!1,this.isOpen=!1,this.disconnect=void 0}updateForElement(){this.forElement=this.getForElement(),this.forElement.setAttribute("aria-haspopup","true")}onKeyDown(e){switch(e.key){case"Escape":this.forElement.focus();break}}onFocusout(e){if(!this.closeOnClickOutside&&this.displayDismissButton)return;e.relatedTarget&&!this.root.contains(e.relatedTarget)&&this.dismiss()}checkForClickOutside(e){const o=e.composedPath(),r=c(this.root,this.for),i=o.includes(r);(this.closeOnClickOutside||!this.displayDismissButton)&&this.isOpen&&!i&&this.dismiss()}async guxDismissPopover(){this.dismiss()}async guxFocusPopover(){this.focusPopup()}get titleSlot(){return u(this.root,"title")}get footerSlot(){return u(this.root,"footer")}getForElement(){if(this.for){const e=c(this.root,this.for);return e||this.logForAttributeError(),e}else this.logForAttributeError()}focusPopup(){const e=this.root.querySelector("[autoFocus]");e?e==null||e.focus():this.popupElement.focus()}runUpdatePosition(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition(),this.root.isConnected?this.cleanupUpdatePosition=b(c(this.root,this.for),this.popupElement,()=>this.updatePosition(),{ancestorScroll:!0,elementResize:!0,animationFrame:!0,ancestorResize:!0}):this.disconnectedCallback()}updatePosition(){const e=c(this.root,this.for);this.popupElement&&e&&E(e,this.popupElement,{placement:this.position,middleware:[x(7),w(),k(),y(),P({element:this.arrowElement,padding:16})]}).then(({x:o,y:r,middlewareData:i,placement:n})=>{Object.assign(this.popupElement.style,{left:`${o}px`,top:`${r}px`});const t=n.split("-")[0],p={top:"bottom",right:"left",bottom:"top",left:"right"}[t],a={top:0,right:90,bottom:180,left:-90}[t],f=t==="left"||t==="right"?15:13;if(i.arrow){let l=i.arrow.x;const d=i.arrow.y;(t==="left"||t==="right")&&(l=l+4),this.popupElement.setAttribute("data-placement",n),Object.assign(this.arrowElement.style,{left:l!=null?`${l}px`:"",top:d!=null?`${d}px`:"",right:"",bottom:"",[p]:`${-f}px`,transform:`rotate(${a}deg)`})}i.hide&&Object.assign(this.popupElement.style,{visibility:i.hide.referenceHidden?"hidden":"visible"})})}dismiss(){this.guxdismiss.emit().defaultPrevented||(this.isOpen=!1,this.popupElement.hidePopover())}logForAttributeError(){this.root.isConnected&&console.error(`gux-popover: invalid element supplied to 'for': "${this.for}"`)}onKeydown(e){switch(e.key){case"Enter":case" ":e.preventDefault(),this.popupElement.togglePopover(),this.isOpen=!this.isOpen,this.runUpdatePosition(),this.focusPopup();break}}onMouseup(){this.popupElement.togglePopover(),this.isOpen=!this.isOpen,this.runUpdatePosition()}connectedCallback(){this.updateForElement(),C(this.root,{variant:this.position});const e=this.onKeydown.bind(this);this.forElement.addEventListener("keydown",e);const o=this.onMouseup.bind(this);this.forElement.addEventListener("mouseup",o),this.disconnect=()=>{this.forElement.removeEventListener("keydown",e),this.forElement.removeEventListener("mouseup",o)}}componentDidLoad(){this.forElement&&(this.forElement.popoverTargetElement=this.popupElement,this.isOpen&&(this.popupElement.togglePopover(),this.runUpdatePosition()))}componentDidUpdate(){this.isOpen?this.runUpdatePosition():this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}disconnectedCallback(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition(),this.disconnect()}render(){return s("div",{key:"2383589588df06ca87afdc5caab7fcb4c0006c79",ref:e=>this.popupElement=e,class:{"gux-popover-wrapper":!0,"gux-hidden":!this.isOpen},"data-placement":!0,popover:"manual",tabindex:"-1"},s("div",{key:"3a9bd486c6d5e6605f5051aff3d55cb126a20ede",ref:e=>this.arrowElement=e,class:"gux-arrow"},s("div",{key:"ce1e44cb6d4e5c1570e4ca2237ea368b203fac65",class:"gux-arrow-caret"})),this.displayDismissButton&&s("gux-dismiss-button",{key:"39af5b1260500a86f6a8d9c08f4304ce15895830",onClick:this.dismiss.bind(this)}),s("div",{key:"003b87bcd84e3e6916863f1e330dc2af4619fd8a",class:{"gux-popover-header":!!this.titleSlot}},s("slot",{key:"81443d171a4025393928a8c4a871de070df8e719",name:"title"})),s("div",{key:"e3f038d6f8f25a0d3c73ace24f639146dd756daf",class:"gux-popover-content"},s("slot",{key:"03ca4cc88798d22b6520b1e7b76818d44d646093"})),s("div",{key:"8acb89b6691fedbcf345b24a404ee9e5808ccd41",class:{"gux-popover-footer":!!this.footerSlot}},s("slot",{key:"fca8d485381bfda8dcd09fbb91fbfc2a95a38361",name:"footer"})))}get root(){return v(this)}static get watchers(){return{for:["updateForElement"]}}};U([O({triggerEvents:"mousedown"})],h.prototype,"checkForClickOutside",null);h.style=F;export{h as gux_popover_beta};
