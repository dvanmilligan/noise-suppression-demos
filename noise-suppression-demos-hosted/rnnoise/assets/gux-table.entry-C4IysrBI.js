import{r as u,c as h,f as m,b as d,h as a,H as g,g as f}from"./index-RhTaIPoL.js";import{b as p}from"./index-Bbwiw1Rf-CzeU2kBB.js";import{w as b}from"./when-event-is-from-kLXvN2m9-B4cyA2sH.js";import{r as S}from"./random-html-id-D9jKBqIb-D30kRngR.js";import{t as z}from"./usage-BYFiy2rf-lhiVWKSr.js";import{t as C}from"./en-BIx814vt-Djb_tyvG.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";const w=":host{position:relative;display:block}:host .gux-table{position:relative;block-size:inherit}:host .gux-table .gux-table-container{max-block-size:100%;overflow:auto;scrollbar-color:var(--gse-ui-dataTableItems-scrollbar-foregroundColor) transparent;scrollbar-width:thin}:host .gux-table .gux-table-container.gux-column-resizing-hover,:host .gux-table .gux-table-container.gux-column-resizing{cursor:col-resize}:host .gux-empty-table{display:flex;align-items:center;justify-content:center;block-size:calc(100% - var(--gse-ui-dataTableItems-header-default-height));color:var(--gse-semantic-foreground-container-lowEmphasis);background:var(--gse-semantic-background-container-page-tonalSubtle);font-family:var(--gse-semantic-heading-lg-bold-fontFamily), var(--gse-semantic-theme-fontFamily-headings), sans-serif;font-size:var(--gse-semantic-heading-lg-bold-fontSize);line-height:var(--gse-semantic-heading-lg-bold-lineHeight);font-weight:var(--gse-semantic-heading-lg-bold-fontWeight)}",R=3,x=class{constructor(e){u(this,e),this.guxselectionchanged=h(this,"guxselectionchanged",7),this.guxsortchanged=h(this,"guxsortchanged",7),this.slotObserver=new MutationObserver(()=>{this.prepareSelectableRows(),m(this)}),this.tableId=S("gux-table"),this.columnsWidths={},this.isScroll=!1,this.columnResizeHover=!1,this.compact=!1,this.objectTable=!1}async componentWillLoad(){z(this.root),this.i18n=await p(this.root,C)}componentDidLoad(){this.resizableColumns&&this.prepareResizableColumns(),this.prepareSelectableRows(),d(()=>{this.checkScroll()}),!this.resizeObserver&&window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{d(()=>{this.checkScroll()})})),this.resizeObserver&&(this.resizeObserver.observe(this.tableContainer),this.resizeObserver.observe(this.slottedTable)),this.slotObserver.observe(this.slottedTable,{subtree:!0,childList:!0})}checkScroll(){const e=this.tableContainer,t=e.scrollHeight>e.clientHeight,s=e.scrollWidth>e.clientWidth;this.isScroll=t||s}disconnectedCallback(){this.resizeObserver&&(this.resizeObserver.unobserve(this.tableContainer),this.resizeObserver.unobserve(this.slottedTable)),this.resizableColumns&&document.getElementById(`${this.tableId}-resizable-styles`).remove()}onInternalAllRowSelectChange(e){e.stopPropagation(),this.handleSelectAllRows(e.detail)}onInternalRowSelectChange(e){e.stopPropagation();const t=e.target;t.selected=e.detail,this.handleRowSelection(t)}onMouseMove(e){this.resizableColumns&&this.updateResizeState(e)}onMouseDown(e){this.resizableColumns&&this.maybeStartResizing(e)}onMouseUp(){this.resizableColumns&&this.stopResizing()}get tableContainer(){return this.root.shadowRoot.querySelector(".gux-table-container")}get slottedTable(){return this.root.querySelector('table[slot="data"]')}get tableRows(){return Array.from(this.slottedTable.querySelectorAll("tbody tr"))}get tableColumns(){return Array.from(this.slottedTable.querySelectorAll("thead th"))}get rowCheckboxes(){return Array.from(this.slottedTable.querySelectorAll("tbody tr td gux-row-select"))}get selectAllCheckbox(){return this.slottedTable.querySelector("thead tr th gux-all-row-select")}async getSelected(){return this.getSelectedInternal()}getSelectedInternal(){return{selectedRowIds:Array.from(this.rowCheckboxes).filter(s=>s.selected).map(s=>s.closest("tr").getAttribute("data-row-id"))}}prepareSelectableRows(){this.rowCheckboxes.forEach(t=>{this.updateRowSelection(t)}),this.updateSelectAllBoxState()}updateSelectAllBoxState(){const e=this.selectAllCheckbox;if(e){const t=this.rowCheckboxes,s=t.filter(l=>!l.disabled),i=s.filter(l=>l.selected),r=!!t.length,n=i.length===s.length,c=i.length===0;e.selected=r&&n,e.setIndeterminate(r&&!n&&!c)}}handleSelectAllRows(e){this.rowCheckboxes.forEach(s=>{s.disabled||(s.selected=e,this.updateRowSelection(s))}),this.emitSelectionEvent()}handleRowSelection(e){this.updateRowSelection(e),this.updateSelectAllBoxState(),this.emitSelectionEvent()}emitSelectionEvent(){this.guxselectionchanged.emit(this.getSelectedInternal())}updateRowSelection(e){const t=e.closest("tr");e.selected?t.setAttribute("data-selected-row",""):t.removeAttribute("data-selected-row")}prepareResizableColumns(){const e=document.createElement("style");e.id=`${this.tableId}-resizable-styles`,document.querySelector("head").appendChild(e),this.calculateColumnWidths(this.tableColumns).slice(0,-1).forEach(s=>this.columnsWidths[s.name]=s.width),this.setResizableColumnsStyles()}updateResizeState(e){if(this.columnResizeState){const s=this.columnResizeState.resizableColumn.dataset.columnName,i=e.pageX-this.columnResizeState.columnResizeMouseStartX,n=this.columnResizeState.resizableColumnInitialWidth+i,c=Math.max(n,1),l=this.calculateColumnWidths(this.tableColumns).map(o=>o.name===s?Object.assign(Object.assign({},o),{width:c}):o);this.columnsWidths[s]=l.find(o=>o.name===s).width,this.setResizableColumnsStyles()}else this.columnResizeHover=!1,b("th",e,t=>{!(this.tableColumns.length-1===t.cellIndex)&&this.isInResizeZone(e,t)&&(this.columnResizeHover=!0)})}maybeStartResizing(e){b("th",e,t=>{if(this.isInResizeZone(e,t)){const s=t;this.columnResizeState={resizableColumn:s,columnResizeMouseStartX:e.pageX,resizableColumnInitialWidth:s.clientWidth}}})}stopResizing(){this.columnResizeState&&(this.columnResizeState=null)}isInResizeZone(e,t){return t.getBoundingClientRect().right-e.clientX<R}calculateColumnWidths(e){return e.map(t=>({name:t.dataset.columnName,width:t.clientWidth}))}setResizableColumnsStyles(){const e=document.getElementById(`${this.tableId}-resizable-styles`);let t="";Object.keys(this.columnsWidths).forEach(s=>{t+=`[gs-table-id=${this.tableId}] th[data-column-name="${s}"]{
        width:${String(this.columnsWidths[s])}px;
        min-width:${String(this.columnsWidths[s])}px;
      }`}),e.textContent=t}get isTableEmpty(){return this.tableColumns&&this.tableRows.length<1}get tableContainerClasses(){return{"gux-table-container":!0,"gux-column-resizing":!!this.columnResizeState,"gux-column-resizing-hover":this.columnResizeHover}}render(){return a(g,{key:"b7605ffe1a38455d1b9507c0d1d8fa34804c61fe","gs-table-id":this.tableId,"gs-obj-table":this.objectTable,"gs-compact":this.compact},a("div",{key:"b50d23e245e812eeca9dbfc390ba6bfa092f4172",class:"gux-table"},a("div",{key:"3efcf0a4bc0ec95bad9c55a77478b094c9695835",tabindex:this.isScroll?"0":"-1",id:this.tableId,class:this.tableContainerClasses},a("slot",{key:"796aedab8db99ac3a4cf747de5975d1e72c4d442",name:"data"})),this.isTableEmpty&&a("div",{key:"3df1f6fbafeed0671ef5707e8a442a2057caaa45",class:"gux-empty-table"},this.emptyMessage||this.i18n("emptyMessage"))))}get root(){return f(this)}};x.style=w;export{x as gux_table};
