import{r as p,h as s,g as x}from"./index-RhTaIPoL.js";import{s as o}from"./safe-regexp-string-D8NvUiBF-i3jlbB13.js";import{t as f}from"./usage-BYFiy2rf-lhiVWKSr.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";const l=/[ +]/g,a=new Map,m=new Map;function b(t,e){let i=a.get(t);return i||(i=C(t),a.set(t,i)),i.test(e)}function k(t){return t.split(l).map(o).map(e=>{let i=m.get(e);return i||(i=new RegExp(e,"i"),m.set(e,i)),i})}function C(t){const e=t.split(l).map(o);return e.length===0?/(?!)/:e.length===1?new RegExp(e[0],"i"):new RegExp("("+e.join(").*?(")+").*?$","i")}function n(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#x2F;")}const w="span mark{background-color:var(--gse-ui-search-match-firstLevel-backgroundColor)}.gux-dimmed mark{background-color:var(--gse-ui-search-match-subsequentLevel-backgroundColor)}",L=class{constructor(t){p(this,t),this.strategy="start",this.dimmed=!1}componentWillLoad(){f(this.root)}render(){if(this.highlight&&this.text)switch(this.strategy){case"start":return this.renderStartsWith();case"contains":return this.renderContains();case"fuzzy":return this.renderFuzzy()}return s("span",{class:{"gux-dimmed":this.dimmed}},this.text)}renderStartsWith(){if(this.text.toLowerCase().startsWith(this.highlight.toLowerCase())){const t=this.text.substring(0,this.highlight.length),e=this.text.substring(this.highlight.length);return s("span",{class:{"gux-dimmed":this.dimmed}},s("mark",null,t),e)}return s("span",{class:{"gux-dimmed":this.dimmed}},this.text)}renderContains(){const t={highlighted:"",remaining:this.text};for(;t.remaining.toLowerCase().includes(this.highlight.toLowerCase());){const e=t.remaining.toLowerCase().indexOf(this.highlight.toLowerCase()),i=t.remaining.substring(0,e),r=t.remaining.substring(e,e+this.highlight.length);t.highlighted+=n(i)+`<mark>${n(r)}</mark>`,t.remaining=t.remaining.substring(e+r.length)}return s("span",{class:{"gux-dimmed":this.dimmed},innerHTML:t.highlighted+n(t.remaining)})}renderFuzzy(){if(b(this.highlight,this.text)){const t=k(this.highlight).reduce((e,i)=>{const{0:r,index:h,input:g}=e.remaining.match(i),c=g.substring(0,h),u=`${e.highlighted+n(c)}<mark>${n(r)}</mark>`,d=g.substring(h+r.length);return{highlighted:u,remaining:d}},{highlighted:"",remaining:this.text});return s("span",{class:{"gux-dimmed":this.dimmed},innerHTML:t.highlighted+n(t.remaining)})}return s("span",{class:{"gux-dimmed":this.dimmed}},this.text)}get root(){return x(this)}};L.style=w;export{L as gux_text_highlight};
