import{r as F,c as C,h as s,g as D}from"./index-RhTaIPoL.js";import{a as I,c as w,o as R,f as E}from"./floating-ui.dom-s4o__4X6-DwnQVfa1.js";import{r as f}from"./random-html-id-D9jKBqIb-D30kRngR.js";import{a as p}from"./after-next-render-Bg4q97BS-C_KTwidI.js";import{f as d,a as m,b as x,c as v}from"./iso-dates-BFybQmZw-sl_E9tb6.js";import{O as S}from"./on-click-outside-C-8pG9cs-6YGsTWW7.js";import{t as M}from"./usage-BYFiy2rf-lhiVWKSr.js";import{b as O}from"./index-Bbwiw1Rf-CzeU2kBB.js";import{g as V,a as P}from"./spark-intl-CJJbLxeY-BrpETJ5c.js";import{u as Y}from"./use-regional-dates-BgaA4g76-C5bTvd2o.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";import"./get-closest-element-DCZG2J0G-kuMVup89.js";const z="Start",T="End",U="Date",A="Toggle calendar view";var B={start:z,end:T,date:U,toggleCalendar:A};function W(e,t,i){const r=e.split(",").map(a=>a.trim());return t==="range"?[r[0]||i[0],r[1]||i[1]]:t!=="range"&&!r[0]?[i[2]]:[r[0]]}function L(e,t,i){return i&&i<e||t&&t>e}function $(e){let t=e;for(;t<0;)t+=12;return t=t%12,t}function b(e,t){let i=new Date(t.getTime());return i.setDate(i.getDate()+e),e<0?i.getDate()>t.getDate()&&(i=new Date(t.getFullYear(),t.getMonth()+1,0,0,0,0)):i.getDate()<t.getDate()&&i.setMonth(i.getMonth()-1),i}function k(e,t){const i=new Date(t.valueOf()),r=$(i.getMonth()+e);return i.setMonth(r),i.setFullYear(t.getFullYear()),i.getMonth()!==r?k(e,b(-1,t)):i}function j(e,t){const i=new Date(t.valueOf());return i.setFullYear(t.getFullYear()+e),i}function K(e){return`0${e.getDate().toString()}`.slice(-2)}function H(e){return`0${(e.getMonth()+1).toString()}`.slice(-2)}function N(e,t){return t==="yyyy"?e.getFullYear().toString():e.getFullYear().toString().slice(-2)}function _(e,t){const i=g(t);return t.split(i).map(a=>{switch(a[0]){case"d":return K(e);case"m":return H(e);case"y":return N(e,a)}}).join(i)}function u(e,t){const i=e[t];return!i||i==="/"?e[t-1]:i}function g(e){return e.match(/\W/)[0]}function q(e,t){const i=h(e),r=u(e,t.selectionStart),n=(i.indexOf(r)+i.length-1)%i.length,o=i[n];return c(e,o)}function G(e,t){const i=h(e),r=u(e,t.selectionStart),n=(i.indexOf(r)+1)%i.length,o=i[n];return c(e,o)}function h(e){const t=g(e);return e.split(t).reduce((i,r)=>i.concat(r[0]),[])}function c(e,t){const i=e.indexOf(t),r=e.lastIndexOf(t)+1;return{selectionStart:i,selectionEnd:r}}const J=":host{display:block;inline-size:fit-content;min-inline-size:115px}.gux-datepicker{display:flex}.gux-datepicker.gux-disabled{pointer-events:none;cursor:default}.gux-datepicker.gux-disabled .gux-datepicker-field .gux-datepicker-field-input{opacity:var(--gse-ui-datePicker-disabled-opacity)}.gux-datepicker .gux-datepicker-field{display:inline-flex;flex-direction:row;flex-wrap:nowrap;place-content:flex-start flex-start;align-items:center;inline-size:100%}.gux-datepicker .gux-datepicker-field~.gux-datepicker-field{margin-inline-start:var(--gse-ui-datePicker-range-gap)}.gux-datepicker .gux-datepicker-field.gux-above{flex-direction:column;align-items:self-start}.gux-datepicker .gux-datepicker-field.gux-above .gux-datepicker-field-input{margin-block-start:0}.gux-datepicker .gux-datepicker-field.gux-above .gux-datepicker-field-label{padding-block-end:var(--gse-ui-formControl-formField-gap);margin-inline-end:0}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-label{flex:0 1 auto;align-self:auto;order:0;min-inline-size:var(--gse-ui-formControl-input-textfield-minWidth);margin-inline-end:var(--gse-ui-formControl-group-gapItems);font-family:var(--gse-ui-formControl-label-textBold-fontFamily);font-size:var(--gse-ui-formControl-label-textBold-fontSize);font-weight:var(--gse-ui-formControl-label-textBold-fontWeight);line-height:var(--gse-ui-formControl-label-textBold-lineHeight);color:var(--gse-ui-formControl-label-labelColor)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input{box-sizing:border-box;display:flex;flex-direction:row;flex-wrap:nowrap;gap:var(--gse-ui-formControl-input-gap);place-content:stretch center;align-items:center;inline-size:100%;block-size:var(--gse-ui-formControl-input-textfield-height);padding:var(--gse-ui-formControl-input-padding);color:var(--gse-ui-formControl-input-populatedColor);white-space:nowrap;background-color:var(--gse-ui-formControl-input-backgroundColor);background-image:none;border:var(--gse-ui-formControl-input-default-border-width) var(--gse-ui-formControl-input-default-border-style) var(--gse-ui-formControl-input-default-border-color);border-radius:var(--gse-ui-formControl-input-borderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input:hover{border:var(--gse-ui-formControl-input-hover-border-width) var(--gse-ui-formControl-input-hover-border-style) var(--gse-ui-formControl-input-hover-border-color)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input:focus-within{outline:var(--gse-ui-formControl-input-focus-border-width) var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusOutline-offset);border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input.gux-active{outline:var(--gse-ui-formControl-input-focus-border-width) var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusOutline-offset);border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input{box-sizing:border-box;display:flex;flex:1 1 auto;flex-direction:row;flex-wrap:nowrap}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input{flex:1 1 auto;align-self:auto;order:0;inline-size:calc(var(--gse-ui-calendarMenu-day-input-width) - var(--gse-ui-icon-small-size));inline-size:100%;padding:0;overflow:hidden;font-family:var(--gse-ui-formControl-input-contentText-fontFamily);font-size:var(--gse-ui-formControl-input-contentText-fontSize);font-weight:var(--gse-ui-formControl-input-contentText-fontWeight);line-height:var(--gse-ui-formControl-input-contentText-lineHeight);color:var(--gse-ui-formControl-input-populatedColor);outline:none;background-color:var(--gse-ui-formControl-input-backgroundColor);border:none}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::placeholder{color:var(--gse-ui-formControl-input-placeholderColor);opacity:1}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-search-cancel-button,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-search-results-button,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input input::-webkit-calendar-picker-indicator{display:none;-webkit-appearance:none}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button{display:flex;flex:0 1 auto;align-items:center;align-self:auto;justify-content:center;order:0;padding:0;color:var(--gse-ui-formControl-input-inputIcon-iconEndColor);outline:none;background:transparent;border:none;border-radius:var(--gse-ui-actionButton-borderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:focus-within{outline:var(--gse-ui-formControl-input-focus-border-width) var(--gse-ui-formControl-input-focus-border-style) var(--gse-ui-formControl-input-focus-border-color);outline-offset:var(--gse-semantic-focusOutline-offset);border:var(--gse-ui-formControl-input-active-border-width) var(--gse-ui-formControl-input-active-border-style) var(--gse-ui-formControl-input-active-border-color);border-radius:var(--gse-ui-formControl-focusRing-borderRadius);outline-offset:var(--gse-ui-datePicker-focusCalendar-gap);border:none;border-radius:var(--gse-ui-calendarMenu-month-calendarButton-focusBorderRadius)}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):focus-visible,.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):hover{color:var(--gse-ui-datePicker-iconHover);cursor:pointer}.gux-datepicker .gux-datepicker-field .gux-datepicker-field-input gux-calendar{position:fixed;z-index:var(--gse-semantic-zIndex-popup);display:none}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button{color:var(--gse-ui-formControl-input-inputIcon-iconEndColor)}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):focus-visible,.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input .gux-datepicker-field-text-input button:not(:disabled):hover{color:var(--gse-ui-formControl-input-inputIcon-iconEndColor)}.gux-datepicker.gux-active .gux-datepicker-field .gux-datepicker-field-input gux-calendar{display:block}.gux-sr-only{position:absolute;top:auto;left:-10000px;width:1px;height:1px;overflow:hidden}";var Q=function(e,t,i,r){var a=arguments.length,n=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(a<3?o(n):a>3?o(t,i,n):o(t,i))||n);return a>3&&n&&Object.defineProperty(t,i,n),n};const y=class{constructor(e){F(this,e),this.input=C(this,"input",7),this.yearFormat="yyyy",this.isSelectingRangeWithMouse=!1,this.lastYear=new Date().getFullYear(),this.startInputId=f("gux-datepicker"),this.endInputId=f("gux-datepicker"),this.label="",this.numberOfMonths=1,this.minDate="",this.maxDate="",this.mode="single",this.disabled=!1,this.labelPosition="beside",this.formattedValue="",this.toFormattedValue="",this.active=!1,this.pressedKeys=[]}watchValue(){this.format&&this.updateDate()}watchMinDate(e){e?this.minDateDate=d(e):this.minDateDate=null}watchMaxDate(e){e?this.maxDateDate=d(e):this.maxDateDate=null}watchFormat(e){e||(this.format=this.getDefaultFormat(),e=this.format),e.includes("yyyy")||(this.yearFormat="yy"),this.intervalOrder=h(e),this.lastIntervalRange=this.initialIntervalRange,this.updateDate()}watchActiveCalendar(e){if(e===!0){const t=d(this.value.split("/")[0]);this.calendarElement.resetCalendarView(t)}}onKeyDown(e){if(this.isInputFieldEvent(e))switch(this.focusedField=this.getInputFieldFromEvent(e),e.key){case"Enter":case"Escape":this.focusedField.blur(),this.active=!1;break;case"Tab":break;case"ArrowDown":e.preventDefault(),this.increment(-1),this.setCursorRange();break;case"ArrowUp":e.preventDefault(),this.increment(1),this.setCursorRange();break;case"ArrowLeft":{e.preventDefault();const t=q(this.format,this.intervalRange);this.setIntervalRange(t),this.setCursorRange(),this.pressedKeys.length=0;break}case"ArrowRight":{e.preventDefault();const t=G(this.format,this.intervalRange);this.setIntervalRange(t),this.setCursorRange(),this.pressedKeys.length=0;break}default:e.preventDefault(),this.isSelectingRangeWithMouse||(this.setIntervalRange({selectionStart:this.focusedField.selectionStart,selectionEnd:this.focusedField.selectionEnd}),this.updateIntervalValue(e),this.setCursorRange());break}else switch(e.key){case"Enter":case"Escape":case" ":{this.active=!1;const t=this.root.shadowRoot.querySelector(".gux-calendar-toggle-button");p(()=>{t.focus()});break}case"Tab":this.active&&(this.active=!1);break}}onMouseDown(e){this.isInputFieldEvent(e)&&(this.isSelectingRangeWithMouse=!0);const t=e.composedPath(),i=t.includes(this.datepickerElement);Array.from(this.root.shadowRoot.querySelectorAll(".gux-calendar-toggle-button")).every(a=>!t.includes(a))&&(this.active=i)}onClickOutside(){this.active=!1,this.pressedKeys.length=0}onInputFocusIn(e){this.focusedField=this.getInputFieldFromEvent(e),this.isSelectingRangeWithMouse||p(()=>this.setRange())}onInputFocusOut(){this.lastIntervalRange=this.initialIntervalRange}onInputMouseUp(e){e.preventDefault(),this.lastIntervalRange=c(this.format,u(this.format,this.focusedField.selectionStart)),this.setRange(),this.isSelectingRangeWithMouse=!1}getDefaultFormat(){return Y()?V(P(this.root)):"mm/dd/yyyy"}isInputFieldEvent(e){const t=e.composedPath();return t.includes(this.inputElement)||t.includes(this.toInputElement)}get initialIntervalRange(){return c(this.format,u(this.format,0))}getInputFieldFromEvent(e){return e.composedPath()[0]}updateIntervalValue(e){this.pressedKeys.push(e.key);const t=parseInt(e.key,10);if(!isNaN(t)){const i=this.focusedField.value.slice(this.focusedField.selectionStart,this.focusedField.selectionEnd);u(this.format,this.focusedField.selectionStart)==="y"&&this.yearFormat==="yyyy"?this.typeYearValue(i,e.key):this.canSetDate(t)&&this.pressedKeys.length>=2?(this.updateSelection(this.focusedField,`${i[1]}${e.key}`),this.setValue()):(this.updateSelection(this.focusedField,`0${e.key}`.replace("00","01")),this.setValue())}}updateSelection(e,t){e.value=(e.value.substr(0,this.intervalRange.selectionStart)+t+e.value.substr(this.intervalRange.selectionEnd)).substring(0,this.format.length)}getCalendarLabels(){return W(this.label,this.mode,[this.i18n("start"),this.i18n("end"),this.i18n("date")])}stringToDate(e){const t=g(this.format),i=this.format.toLowerCase().split(t),r=e.split(t),a=parseInt(r[i.indexOf(this.yearFormat)],10),n=parseInt(r[i.indexOf("mm")],10)-1,o=parseInt(r[i.indexOf("dd")],10),l=new Date(a,n,o);return this.yearFormat==="yy"&&l.getFullYear()<1970&&this.lastYear>1970&&l.setFullYear(l.getFullYear()+100),l}onCalendarSelect(e){const t=e.target;this.value=t.value,e.stopPropagation(),this.input.emit(this.value),this.updateDate(),this.inputElement.value=this.formattedValue,this.mode==="range"&&(this.toInputElement.value=this.toFormattedValue),(document.activeElement!==this.inputElement||document.activeElement!==this.toInputElement)&&(this.active=!1)}setValue(){if(this.mode==="range"){const e=this.stringToDate(this.inputElement.value),t=this.stringToDate(this.toInputElement.value);if(!this.isValidDateFormat(e)||!this.isValidDateFormat(t))return;const i=e>t;this.value=m(e,t),this.updateDate(),this.inputElement.value=this.formattedValue,this.toInputElement.value=this.toFormattedValue,i?(this.focusedField===this.inputElement?this.toInputElement:this.inputElement).focus():this.setCursorRange(),this.calendarElement.setValue([e,t])}else{const e=this.stringToDate(this.inputElement.value);if(!this.isValidDateFormat(e))return;this.value=x(e),this.updateDate(),this.calendarElement.setValue(e)}this.input.emit(this.value)}setRange(){this.setIntervalRange(this.lastIntervalRange),this.setCursorRange()}typeYearValue(e,t){e[0]!==" "?this.updateSelection(this.focusedField,`   ${t}`):(this.updateSelection(this.focusedField,`${e.substr(1)}${t}`),(e.substr(1)+t).includes(" ")||this.setValue())}canSetDate(e){const t=parseInt([this.focusedField.value[this.intervalRange.selectionEnd-1].toString(),e].join(""),10);if(t)switch(u(this.format,this.focusedField.selectionStart)){case"d":{const i=d(this.value);if(t<=new Date(i.getFullYear(),i.getMonth()+1,0).getDate())return!0;break}case"m":if(t<=12)return!0;break;case"y":return!0}return!1}getMapAndRegexFromField(e){const t={dd:`0${e.getDate()}`.slice(-2),mm:`0${e.getMonth()+1}`.slice(-2)};this.yearFormat==="yyyy"?t.yyyy=e.getFullYear().toString():t.yy=e.getFullYear().toString().slice(-2);const i=this.yearFormat==="yyyy"?"dd|mm|yyyy":"dd|mm|yy",r=new RegExp(i,"gi");return{map:t,regexp:r}}isValidDateFormat(e){const{map:t}=this.getMapAndRegexFromField(e);return this.yearFormat==="yyyy"?t.yyyy.length===4:t.yy.length===2}updateDate(){if(this.mode==="range"){const[e,t]=v(this.value),{map:i,regexp:r}=this.getMapAndRegexFromField(e);this.formattedValue=this.format.replace(r,o=>i[o]);const{map:a,regexp:n}=this.getMapAndRegexFromField(t);this.toFormattedValue=this.format.replace(n,o=>a[o])}else{const e=d(this.value),{map:t,regexp:i}=this.getMapAndRegexFromField(e);this.formattedValue=this.format.replace(i,r=>t[r])}}setCursorRange(){this.intervalRange&&(this.focusedField.setSelectionRange(0,100),this.focusedField.setSelectionRange(this.intervalRange.selectionStart,this.intervalRange.selectionEnd))}toggleCalendar(){this.active=!this.active,this.active&&p(()=>{this.calendarElement.focusPreviewDate()})}setIntervalRange(e){this.intervalRange=e}getCombinedFocusedDateValue(){return this.mode==="range"?this.getRangeFocusedDateValue():this.getFocusedDateValue()}getFocusedDateValue(){return d(this.value)}getRangeFocusedDateValue(){const[e,t]=v(this.value);return this.focusedField===this.inputElement?e:t}increment(e){const t=u(this.format,this.focusedField.selectionStart),i=this.getCombinedFocusedDateValue();let r;switch(t){case"d":r=b(e,i);break;case"m":r=k(e,i);break;case"y":r=j(e,i);break}L(r,this.minDateDate,this.maxDateDate)&&(r=i),this.lastYear=r.getFullYear(),this.setIntervalRange({selectionStart:this.focusedField.selectionStart,selectionEnd:this.focusedField.selectionEnd}),this.focusedField.value=_(r,this.format),this.setValue()}async componentWillLoad(){if(M(this.root,{variant:this.mode}),this.i18n=await O(this.root,B),this.format=this.format||this.getDefaultFormat(),this.watchMinDate(this.minDate),this.watchMaxDate(this.maxDate),this.watchFormat(this.format),!this.value){const e=new Date;e.setHours(0,0,0,0),this.mode==="range"?this.value=m(e,e):this.value=x(e),this.mode==="range"&&this.numberOfMonths<2&&(this.numberOfMonths=2)}this.updateDate()}runUpdatePosition(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition(),this.cleanupUpdatePosition=I(this.datepickerElement,this.calendarElement,()=>this.updatePosition(),{ancestorScroll:!0,elementResize:!0,animationFrame:!0,ancestorResize:!0})}updatePosition(){w(this.datepickerElement,this.calendarElement,{strategy:"fixed",placement:"bottom-start",middleware:[R({crossAxis:-3}),E({fallbackStrategy:"initialPlacement"})]}).then(({x:e,y:t})=>{Object.assign(this.calendarElement.style,{left:`${e}px`,top:`${t}px`})})}componentDidUpdate(){this.active?this.runUpdatePosition():this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}disconnectedCallback(){this.cleanupUpdatePosition&&this.cleanupUpdatePosition()}renderCalendarToggleButton(){return s("button",{class:"gux-calendar-toggle-button",type:"button",onClick:()=>this.toggleCalendar(),"aria-expanded":this.active.toString(),"aria-label":this.i18n("toggleCalendar"),disabled:this.disabled},s("gux-icon",{decorative:!0,"icon-name":"fa/calendar-regular",size:"small"}))}renderCalendar(){return s("gux-calendar",{tabindex:"-1",ref:e=>this.calendarElement=e,value:this.value,mode:this.mode,onCalendarSelect:e=>this.onCalendarSelect(e),minDate:this.minDate,maxDate:this.maxDate,numberOfMonths:this.numberOfMonths,startDayOfWeek:this.startDayOfWeek})}renderStartDateField(){return s("div",{class:{"gux-datepicker-field":!0,"gux-above":this.labelPosition==="above"}},s("label",{htmlFor:this.startInputId,class:{"gux-datepicker-field-label":!0,"gux-sr-only":this.mode==="single"&&!this.label}},this.getCalendarLabels()[0]),s("div",{class:"gux-datepicker-field-input"},s("div",{class:"gux-datepicker-field-text-input"},s("input",{id:this.startInputId,type:"text",onClick:e=>this.onInputMouseUp(e),onFocusin:e=>this.onInputFocusIn(e),onFocusout:()=>this.onInputFocusOut(),ref:e=>this.inputElement=e,value:this.formattedValue,disabled:this.disabled}),this.renderCalendarToggleButton()),this.renderCalendar()))}renderEndDateField(){return this.mode==="single"?null:s("div",{class:{"gux-datepicker-field":!0,"gux-above":this.labelPosition==="above"}},s("label",{htmlFor:this.endInputId,class:"gux-datepicker-field-label"},this.getCalendarLabels()[1]),s("div",{class:"gux-datepicker-field-input"},s("div",{class:"gux-datepicker-field-text-input"},s("input",{id:this.endInputId,type:"text",ref:e=>this.toInputElement=e,onMouseUp:e=>this.onInputMouseUp(e),onFocusin:e=>this.onInputFocusIn(e),onFocusout:()=>this.onInputFocusOut(),value:this.toFormattedValue,disabled:this.disabled}),this.renderCalendarToggleButton())))}render(){return s("div",{key:"5b2c2ce20a7394cc9a3133b1f0ca6602f2301c40",class:{"gux-datepicker":!0,"gux-active":this.active,"gux-disabled":this.disabled},ref:e=>this.datepickerElement=e},this.renderStartDateField(),this.renderEndDateField())}get root(){return D(this)}static get watchers(){return{value:["watchValue"],minDate:["watchMinDate"],maxDate:["watchMaxDate"],format:["watchFormat"],active:["watchActiveCalendar"]}}};Q([S({triggerEvents:"mousedown"})],y.prototype,"onClickOutside",null);y.style=J;export{y as gux_datepicker};
