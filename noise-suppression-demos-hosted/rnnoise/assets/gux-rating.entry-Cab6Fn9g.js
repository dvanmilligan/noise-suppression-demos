import{r as c,h as i,H as d,g as h}from"./index-RhTaIPoL.js";import{s as l}from"./simulate-native-event-BMRf5pjV-BcLDngo1.js";import{c as p}from"./clamp-CcCycvZh-DnrAwabn.js";import{t as f}from"./usage-BYFiy2rf-lhiVWKSr.js";import{l as m}from"./log-error-DxtJDeL9-5foDqi4E.js";import{b}from"./index-Bbwiw1Rf-CzeU2kBB.js";import{O as v}from"./on-click-outside-C-8pG9cs-6YGsTWW7.js";import"vite-plugin-node-polyfills/shims/process";import"vite-plugin-node-polyfills/shims/buffer";import"./get-closest-element-Cd4R0amv-C_5KDHD-.js";const x="Edit Rating";var y={editRating:x};const R=":host{display:inline-block;min-inline-size:fit-content;user-select:none}:host(:host:focus-visible){outline:var(--gse-semantic-focusOutline-sm-borderWidth) solid var(--gse-semantic-border-focus);outline-offset:var(--gse-semantic-focusOutline-offset);box-shadow:0 0 0 1px var(--gse-semantic-border-focus)}.gux-rating-star-container{display:flex;gap:var(--gse-ui-rating-star-gap);justify-content:space-between;color:var(--gse-ui-rating-default-color)}.gux-rating-star-container.gux-disabled{color:var(--gse-ui-rating-disabled-color);pointer-events:none;opacity:var(--gse-ui-rating-disabled-opacity)}.gux-rating-star-container gux-icon{flex:0 0 auto;color:var(--gse-ui-rating-default-color)}.gux-rating-star-container:not(.gux-compact) gux-icon:hover:not(.gux-disabled){color:var(--gse-ui-rating-hover-color);cursor:pointer}.gux-rating-star-container .gux-star-rating-compact{display:flex;flex-direction:column;gap:var(--gse-ui-ratingGroup-shortened-edit-gap);align-items:flex-start;justify-content:center}.gux-rating-star-container .gux-star-rating-compact .gux-star-rating-label-value{display:flex;flex-direction:row;gap:var(--gse-ui-ratingGroup-shortened-gap);align-items:center;justify-content:center}.gux-rating-star-container .gux-star-rating-compact .gux-star-rating-value{font-family:var(--gse-ui-ratingGroup-text-fontFamily);font-size:var(--gse-ui-ratingGroup-text-fontSize);font-weight:var(--gse-ui-ratingGroup-text-fontWeight);line-height:var(--gse-ui-ratingGroup-text-lineHeight);color:var(--gse-ui-ratingGroup-label)}";var w=function(t,e,r,o){var a=arguments.length,n=a<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,r):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(t,e,r,o);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(n=(a<3?s(n):a>3?s(e,r,n):s(e,r))||n);return a>3&&n&&Object.defineProperty(e,r,n),n};const g=class{constructor(t){c(this,t),this.value=0,this.maxValue=5,this.disabled=!1,this.readonly=!1,this.increment="default",this.compact=!1,this.isOpen=!1}onClickOutside(){this.isOpen=!1}onFocusIn(){this.compact&&this.compactRatingElement.focus()}onClick(t){if(t.stopPropagation(),this.disabled||this.readonly||this.compact)return;const[e]=t.composedPath(),r=e.getRootNode(),a=Array.from(this.starContainer.children).findIndex(n=>n.shadowRoot===r)+1;a===this.value+.5?this.updateRatingValue(a):a===this.value?this.updateRatingValue(0):a!==Math.floor(this.value)?this.increment==="half"?this.updateRatingValue(a-.5):this.updateRatingValue(a):this.updateRatingValue(a)}onKeyDown(t){if(t.stopPropagation(),this.disabled||this.readonly||this.isOpen)return;const e=this.increment==="half"?.5:1;switch(t.key){case"ArrowUp":case"ArrowRight":t.preventDefault(),this.updateRatingValue(this.value+e);break;case"ArrowDown":case"ArrowLeft":t.preventDefault(),this.updateRatingValue(this.value-e);break;case"End":t.preventDefault(),this.updateRatingValue(1/0);break;case"Home":t.preventDefault(),this.updateRatingValue(-1/0);break}}get ariaLabel(){var t;return(t=this.root)===null||t===void 0?void 0:t.getAttribute("aria-label")}get ariaLabelledby(){var t;return(t=this.root)===null||t===void 0?void 0:t.getAttribute("aria-labelledby")}updateRatingValue(t){const e=p(t,0,this.maxValue),r=this.increment==="half"?.5:1,o=Math.round(e/r)*r;this.value!==o&&(this.value=o,l(this.root,"input"),l(this.root,"change"))}getRatingStarElements(){return[...Array(this.maxValue).keys()].reduce((t,e)=>e+.5===this.value?t.concat("fa/star-sharp-half-stroke-regular"):e+1<=this.value?t.concat("fa/star-solid"):t.concat("fa/star-regular"),[]).map(t=>i("gux-icon",{"icon-name":t,decorative:!0,size:"small"}))}getCompactRatingElement(){let t;return this.value===0?t="fa/star-regular":t="fa/star-solid",i("div",{class:"gux-star-rating-compact"},i("div",{class:"gux-star-rating-label-value"},i("gux-icon",{tabindex:"0",ref:e=>this.compactRatingElement=e,"icon-name":t,decorative:!0,size:"small"}),i("span",{class:"gux-star-rating-value"},this.value)),this.renderEditRatingButton())}renderEditRatingButton(){if(!this.readonly)return i("div",{class:"gux-edit-rating-button"},i("gux-button",{tabindex:"-1",onClick:()=>{this.togglePopover()},id:"popover-target",accent:"inline",disabled:this.disabled},this.i18n("editRating")),i("gux-popover-beta",{position:"bottom-start",for:"popover-target","is-open":this.isOpen},i("gux-rating",{tabindex:"-1",value:this.value,"max-value":this.maxValue,increment:this.increment,readonly:this.readonly,onClick:t=>this.handlePopoverRatingChange(t),"aria-label":this.ariaLabel,"aria-labelledby":this.ariaLabelledby})))}togglePopover(){this.isOpen=!this.isOpen}handlePopoverRatingChange(t){const e=t.target.value;this.value=e,l(this.root,"input"),l(this.root,"change")}getTabIndex(){return this.disabled?-1:0}componentWillLoad(){f(this.root)}async componentWillRender(){this.i18n=await b(this.root,y)}componentDidLoad(){this.root.getAttribute("aria-label")||this.root.getAttribute("aria-labelledby")||m(this.root,"`gux-rating` requires a label. Either provide a label and associate it with the gux-rating element using `aria-labelledby` or add an `aria-label` attribute to the gux-rating element.")}renderStars(){return this.compact?this.getCompactRatingElement():this.getRatingStarElements()}render(){return i(d,{key:"f1bb366debd8ed0424fc4ef22851b9daf35a01c8",role:"spinbutton",tabindex:this.getTabIndex(),"aria-readonly":this.readonly.toString(),"aria-valuenow":this.value,"aria-valuemin":"0","aria-valuemax":this.maxValue},i("div",{key:"7261b4f4882fe95ed85aad76a87f90abe3a71bd5",ref:t=>this.starContainer=t,class:{"gux-rating-star-container":!0,"gux-disabled":this.disabled,"gux-compact":this.compact}},this.renderStars()))}get root(){return h(this)}};w([v({triggerEvents:"mousedown"})],g.prototype,"onClickOutside",null);g.style=R;export{g as gux_rating};
